(this.webpackJsonptournemnt=this.webpackJsonptournemnt||[]).push([[5],{288:function(t,e,n){"use strict";n.r(e);var a=n(63),s=n(64),i=n(66),o=n(65),c=n(0),r=n.n(c),l=n(23),d=n(278),u=n(67),h=n(275),j=n.n(h),b=n(273),m=n.n(b),f=n(274),p=n.n(f),O=n(272),x=n.n(O),v=n(277),g=n.n(v),_=n(276),y=n.n(_),k=n(12);var w=function(t){var e=new Date(1e3*t.timestamp);switch(t.mode){case"day":var n={year:"numeric",month:"long",day:"numeric",timeZone:"Europe/Moscow"};return Object(k.jsx)("span",{children:e.toLocaleDateString("ru-RU",n)});case"time":n={hour:"numeric",minute:"numeric",timeZone:"Europe/Moscow"};return Object(k.jsxs)("span",{children:[e.toLocaleDateString("ru-RU",n),Object(k.jsx)("span",{style:{fontSize:"12px"},children:" (\u041c\u0421\u041a)"})]});case"dayAndTime":n={month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",timeZone:"Europe/Moscow"};return Object(k.jsxs)("span",{children:[e.toLocaleDateString("ru-RU",n),Object(k.jsx)("span",{style:{fontSize:"12px"},children:" (\u041c\u0421\u041a)"})]});default:n={month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",timeZone:"Europe/Moscow"};return Object(k.jsxs)("span",{children:[e.toLocaleDateString("ru-RU",n),Object(k.jsx)("span",{style:{fontSize:"12px"},children:" (\u041c\u0421\u041a)"})]})}};var S=function(t,e){var n=new Date(1e3*t);switch(e){case"day":var a={year:"numeric",month:"long",day:"numeric",timeZone:"Europe/Moscow"};return n.toLocaleDateString("ru-RU",a)+" (\u041c\u0421\u041a)";case"time":a={hour:"numeric",minute:"numeric",timeZone:"Europe/Moscow"};return n.toLocaleDateString("ru-RU",a)+" (\u041c\u0421\u041a)";case"dayAndTime":a={month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",timeZone:"Europe/Moscow"};return n.toLocaleDateString("ru-RU",a)+" (\u041c\u0421\u041a)";default:a={month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",timeZone:"Europe/Moscow"};return n.toLocaleDateString("ru-RU",a)+" (\u041c\u0421\u041a)"}},T=n(271),C=n.n(T),N=n(270),I=n.n(N),M=n(39),B=n.n(M),A=n(286),L=(new Date).getTime(),R=[];var E=function(t){return new Promise((function(e,n){(new Date).getTime()-L>1500&&-1==R.indexOf(t.tournament_id)&&(L=(new Date).getTime(),R.push(t.tournament_id),B.a.send("VKWebAppAllowNotifications").then((function(){var a="https://wotbtournamentvkapp.ru/vkapp/subscribe".concat(window.location.search,"&tournament_id=").concat(t.tournament_id),s=new XMLHttpRequest;s.open("GET",a,!0),s.send(),s.onload=function(){R.splice(R.indexOf(t.tournament_id),1);try{200==JSON.parse(s.responseText)||300==JSON.parse(s.responseText)?e():n()}catch(a){n()}},s.onerror=function(){n()}})).catch((function(){R.splice(R.indexOf(t.tournament_id),1)})))}))};var W,H,P,z,F=function(t){return new Promise((function(e,n){var a="https://wotbtournamentvkapp.ru/vkapp/unsubscribe".concat(window.location.search,"&tournament_id=").concat(t.tournament_id),s=new XMLHttpRequest;s.open("GET",a,!0),s.send(),s.onload=function(){try{200==JSON.parse(s.responseText)?e():n()}catch(t){n()}},s.onerror=function(){n()}}))},D=n(284),q=n(285),G=!1,J=[],K={},V={},X={},U=[];var Z=new XMLHttpRequest;Z.open("POST","https://api.wotblitz.ru/wotb/tournaments/list/?application_id=132530213b8f23d4c0e1d1f423c307a9&status=upcoming",!1),Z.send();var Y=JSON.parse(Z.responseText),Q=Y.data.reduce((function(t,e){var n=new XMLHttpRequest;return n.open("POST","https://api.wotblitz.ru/wotb/tournaments/info/?application_id=132530213b8f23d4c0e1d1f423c307a9&tournament_id="+e.tournament_id+"&fields=teams",!1),n.send(),t[e.tournament_id]=JSON.parse(n.responseText).data[e.tournament_id].teams,t}),{});Y.data.map((function(t){J.push(t.tournament_id),sessionStorage.setItem(t.tournament_id,!0)})),K=Y.data.reduce((function(t,e){return t[e.tournament_id]=Object(k.jsx)(D.a,{width:19,height:21}),t}),{}),V=Y.data.reduce((function(t,e){return t[e.tournament_id]=Object(k.jsx)(D.a,{}),t}),{}),X=Y.data.reduce((function(t,e){return t[e.tournament_id]=Object(k.jsx)(D.a,{width:24,height:24}),t}),{});var $=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(t){var s;return Object(a.a)(this,n),(s=e.call(this,t)).state={activeModal:null,modalHistory:[],popout:null,snackbar:null,elem:null,bellsButtons:K,bellsAndroid:V,bellsIOS:X},s.sendPost=s.sendPost.bind(Object(u.a)(s)),s.shareTargetRef=r.a.createRef(),s.shareLink=s.shareLink.bind(Object(u.a)(s)),s.closeActionSheet=function(){s.setState({popout:null})},s.modalBack=function(){s.setActiveModal(s.state.modalHistory[s.state.modalHistory.length-2]),history.back(),document.body.style.overflow="visible"},s}return Object(s.a)(n,[{key:"subscribeToNotification",value:function(t){var e,n=this;-1==U.indexOf(t.tournament_id)?E(t).then((function(){U.push(t.tournament_id),V[t.tournament_id]=Object(k.jsx)(q.a,{width:28,height:28}),X[t.tournament_id]=Object(k.jsx)(q.a,{}),K[t.tournament_id]=Object(k.jsx)(q.a,{width:19,height:21}),n.setState({bellsAndroid:V}),n.setState({bellsIOS:X}),n.setState({bellsButtons:K}),e=Object(k.jsx)(l.y,{onClose:function(){return n.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--green)"},children:Object(k.jsx)(C.a,{fill:"#fff",width:14,height:14})}),children:"\u0412\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u044b \u043e \u043d\u0430\u0447\u0430\u043b\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u043d\u0430 \u0442\u0443\u0440\u043d\u0438\u0440"}),n.setState({snackbar:e})})).catch((function(){e=Object(k.jsx)(l.y,{onClose:function(){return n.setState({snackbar:null})},duration:"1500",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--red)"},children:Object(k.jsx)(I.a,{fill:"#fff",width:14,height:14})}),children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0435 \u043d\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435"}),n.setState({snackbar:e})})):F(t).then((function(){U.splice(U.indexOf(t.tournament_id),1),V[t.tournament_id]=Object(k.jsx)(D.a,{}),X[t.tournament_id]=Object(k.jsx)(D.a,{width:24,height:24}),K[t.tournament_id]=Object(k.jsx)(D.a,{width:19,height:21}),n.setState({bellsAndroid:V}),n.setState({bellsIOS:X}),n.setState({bellsButtons:K})})).catch((function(){e=Object(k.jsx)(l.y,{onClose:function(){return n.setState({snackbar:null})},duration:"1500",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--red)"},children:Object(k.jsx)(I.a,{fill:"#fff",width:14,height:14})}),children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0438\u0441\u043a\u0435 \u043e\u0442 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),n.setState({snackbar:e})}))}},{key:"buildRequest",value:function(t){return{message:S(t.start_at,"day")+' \u0437\u0430\u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d \u0442\u0443\u0440\u043d\u0438\u0440 "'+t.title+'"\n\n\u041d\u0430\u0447\u0430\u043b\u043e \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: '+S(t.registration_start_at,"dayAndTime")+"\n\u041e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: "+S(t.registration_end_at,"dayAndTime")+"\n\n\u041d\u0430\u0447\u0430\u043b\u043e \u0431\u043e\u0435\u0432: "+S(t.start_at,"dayAndTime")+"\n\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043c\u043e\u0436\u043d\u043e \u0443\u0437\u043d\u0430\u0442\u044c \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438:",attachments:"https://vk.com/app7446072#"+t.tournament_id}}},{key:"sendPost",value:function(){var t=this,e=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--green)"},children:Object(k.jsx)(C.a,{fill:"#fff",width:14,height:14})}),children:"\u0417\u0430\u043f\u0438\u0441\u044c \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u0430"}),n=this.buildRequest(this.state.elem);B.a.send("VKWebAppShowWallPostBox",n).then((function(n){t.state.snackbar||t.setState({snackbar:e})}))}},{key:"shareLink",value:function(){var t=this,e=this.props.viewWidth>l.C.MOBILE,n=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--green)"},children:Object(k.jsx)(C.a,{fill:"#fff",width:14,height:14})}),children:e?"\u0421\u0441\u044b\u043b\u043a\u0430 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430":"\u0421\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430"}),a=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--red)"},children:Object(k.jsx)(I.a,{fill:"#fff",width:14,height:14})}),children:e?"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u0441\u044b\u043b\u043a\u0438":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0441\u0441\u044b\u043b\u043a\u0438"}),s="https://vk.com/app7446072#"+this.state.elem.tournament_id;e?B.a.send("VKWebAppCopyText",{text:s}).then((function(){t.state.snackbar||t.setState({snackbar:n})})).catch((function(){t.state.snackbar||t.setState({snackbar:a})})):B.a.send("VKWebAppShare",{link:s}).then((function(e){if(t.props.viewWidth>l.C.MOBILE){if(t.state.snackbar)return;t.setState({snackbar:n})}}))}},{key:"openShareActionSheet",value:function(t){var e=this;P=!1,z=event.target.closest(".vkuiButton").getBoundingClientRect().height,W=event.target.closest(".vkuiButton").getBoundingClientRect().top,H=event.target.closest(".vkuiButton").getBoundingClientRect().left;var n=this.props.viewWidth>l.C.MOBILE;if(!n){var a={actionShet:t.tournament_id};history.pushState(a,"")}this.setState({elem:t}),this.setState({popout:Object(k.jsxs)(l.b,{onClose:function(){e.setState({popout:null}),n||history.back()},iosCloseItem:Object(k.jsx)(l.c,{autoclose:!0,mode:"cancel",children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),header:"\u041a\u0430\u043a \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u043c?",toggleRef:this.shareTargetRef.current,children:[Object(k.jsx)(l.c,{autoclose:!0,onClick:function(){return e.sendPost()},children:"\u041d\u0430 \u0441\u0442\u0435\u043d\u0435"}),Object(k.jsx)(l.c,{autoclose:!0,onClick:function(){return e.shareLink()},children:n?"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443"})]})})}},{key:"setActiveModal",value:function(t){t=t||null;var e=this.state.modalHistory?Object(d.a)(this.state.modalHistory):[];if(null===t?e=[]:-1!==e.indexOf(t)?e=e.splice(0,e.indexOf(t)+1):e.push(t),this.setState({activeModal:t,modalHistory:e}),null==this.state.activeModal){document.body.style.overflow="hidden",history.pushState({modal:"modal"},"")}}},{key:"checkSubscriptions",value:function(){try{U=JSON.parse(sessionStorage.getItem("activeSubscriptions"))}catch(t){console.log(t)}K=Y.data.reduce((function(t,e){return-1!=U.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{width:19,height:21}):t[e.tournament_id]=Object(k.jsx)(D.a,{width:19,height:21}),t}),{}),V=Y.data.reduce((function(t,e){return-1!=U.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{width:28,height:28}):t[e.tournament_id]=Object(k.jsx)(D.a,{}),t}),{}),X=Y.data.reduce((function(t,e){return-1!=U.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{}):t[e.tournament_id]=Object(k.jsx)(D.a,{width:24,height:24}),t}),{}),this.setState({bellsAndroid:V}),this.setState({bellsIOS:X}),this.setState({bellsButtons:K})}},{key:"componentDidMount",value:function(){var t=this;""==window.location.hash||G||-1==J.indexOf(Number(window.location.hash.slice(1)))||(this.setActiveModal(Number(window.location.hash.slice(1))),G=!0),setTimeout((function(){t.checkSubscriptions()}),500)}},{key:"componentDidUpdate",value:function(){var t=document.getElementsByClassName("vkuiActionSheet--desktop");t[0]&&new MutationObserver((function(e){e&&!P&&(document.documentElement.clientHeight-W<200?W=W-t[0].getBoundingClientRect().height-5:W+=z+5,t[0].style.top=W+"px",t[0].style.left=H+"px",P=!0)})).observe(t[0],{attributes:!0,attributeFilter:["style"]})}},{key:"render",value:function(){var t=this;window.addEventListener("scroll",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("orientationchange",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("popstate",(function(){null!=t.state.popout&&t.closeActionSheet(),null!=t.state.activeModal&&t.modalBack()})),window.addEventListener("storage",(function(){t.checkSubscriptions()}));var e=this.props.viewWidth>l.C.MOBILE,n=this.props.viewWidth<=l.C.MOBILE,a=this.props.platform;if(0!==Y.data.length)var s=Object(k.jsx)(l.p,{activeModal:this.state.activeModal,onClose:this.modalBack,children:Y.data.map((function(e){return Object(k.jsx)(l.n,{id:e.tournament_id,onClose:t.modalBack,header:Object(k.jsx)(l.o,{left:n&&a===l.m&&Object(k.jsx)(l.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsIOS[e.tournament_id]})||n&&a===l.a&&Object(k.jsx)(l.t,{onClick:t.modalBack}),right:n&&a===l.m&&Object(k.jsx)(l.s,{onClick:t.modalBack,children:Object(k.jsx)(A.a,{})})||n&&a===l.a&&Object(k.jsx)(l.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsAndroid[e.tournament_id]})||Object(k.jsx)(l.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsAndroid[e.tournament_id]}),children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),children:Object(k.jsxs)("div",{className:"ModalPage__Content Turnament-Information__Group",children:[Object(k.jsx)(l.k,{className:"vkuiGroup--custom-separator",children:Object(k.jsx)("h4",{children:e.title})}),Object(k.jsxs)(l.k,{className:"vkuiGroup--custom-separator",children:[Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0421\u0442\u0430\u0442\u0443\u0441"}),Object(k.jsx)("div",{style:{marginLeft:5},children:Object(k.jsx)("span",{style:{display:"inline-flex",alignItems:"center"},children:"\u0417\u0430\u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d"})}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(x.a,{width:17,height:17}),Object(k.jsx)(w,{timestamp:e.registration_start_at})]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(m.a,{width:17,height:17}),Object(k.jsx)(w,{timestamp:e.registration_end_at})]})]}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u043e\u0451\u0432"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(p.a,{width:17,height:17,style:{color:"green"}}),Object(k.jsx)(w,{timestamp:e.start_at})]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(p.a,{width:17,height:17,style:{color:"rgb(200, 0, 0)"}}),Object(k.jsx)(w,{timestamp:e.end_at})]})]}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"}),Object(k.jsx)("div",{style:{marginLeft:5},children:Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)("span",{style:{fontWeight:"450"},children:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",Q[e.tournament_id].max]})})]}),Object(k.jsx)(l.k,{className:"vkuiGroup--custom-separator",children:Object(k.jsx)("p",{className:"Pre",children:e.description})})]})})}))}),i=Object(k.jsxs)(l.v,{modal:s,popout:this.state.popout,children:[Object(k.jsx)(l.i,{size:e?"m":"l",children:Y.data.map((function(e){return Object(k.jsxs)(l.h,{mode:"outline",children:[Object(k.jsx)("div",{className:e.status+" border"}),Object(k.jsxs)("div",{className:"TournamentCard",children:[Object(k.jsx)("div",{className:"TournamentCard__Header",children:e.title}),Object(k.jsxs)("div",{className:"TornamentCard__Info",children:[Object(k.jsxs)("div",{className:"TornamentCard__Info-Start",children:[Object(k.jsx)(j.a,{width:23,height:23}),Object(k.jsx)("div",{className:"TornamentCard__Info-Start-Text",children:Object(k.jsx)(w,{timestamp:e.start_at,mode:"day"})})]}),Object(k.jsxs)("div",{className:"TournamentCard__Info-Main",children:[Object(k.jsxs)("div",{className:"TournamentCard__Info-Main-Registration",children:[Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex"},children:[Object(k.jsx)(x.a,{style:{paddingTop:"2.5px"},width:17,height:17}),Object(k.jsx)(w,{mode:"dayAndTime",timestamp:e.registration_start_at})]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex"},children:[Object(k.jsx)(m.a,{style:{paddingTop:"2.5px"},width:17,height:17}),Object(k.jsx)(w,{mode:"dayAndTime",timestamp:e.registration_end_at})]})]})]}),Object(k.jsxs)("div",{className:"TournamentCard__Info-Main-Start",children:[Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041d\u0430\u0447\u0430\u043b\u043e \u0431\u043e\u0451\u0432"}),Object(k.jsx)("div",{style:{marginLeft:5},children:Object(k.jsxs)("span",{style:{display:"inline-flex"},children:[Object(k.jsx)(p.a,{style:{paddingTop:"2.5px"},width:17,height:17}),Object(k.jsx)(w,{timestamp:e.start_at,mode:"dayAndTime"})]})})]})]})]}),Object(k.jsxs)("div",{className:"TornamentCard__Footer",children:[Object(k.jsx)(l.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-InfoButton",mode:"outline",before:Object(k.jsx)(y.a,{}),onClick:function(){return t.setActiveModal(e.tournament_id)},children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"}),Object(k.jsx)(l.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",getRootRef:t.shareTargetRef,onClick:function(){return t.openShareActionSheet(e)},children:Object(k.jsx)(g.a,{})}),Object(k.jsx)(l.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsButtons[e.tournament_id]})]})]})]})}))}),this.state.snackbar]});else if("none"==this.props.mode)i=Object(k.jsx)("span",{});else i=Object(k.jsx)(l.u,{children:"\u041d\u0435\u0442 \u0437\u0430\u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u0432"});return i}}]),n}(r.a.Component),tt=Object(l.E)(Object(l.D)($,{viewWidth:!0})),et=n(280),nt=new XMLHttpRequest;nt.open("POST","https://api.wotblitz.ru/wotb/tournaments/list/?application_id=132530213b8f23d4c0e1d1f423c307a9&status=registration_started",!1),nt.send();var at,st,it,ot,ct,rt=JSON.parse(nt.responseText),lt=rt.data.reduce((function(t,e){var n=new XMLHttpRequest;return n.open("POST","https://api.wotblitz.ru/wotb/tournaments/info/?application_id=132530213b8f23d4c0e1d1f423c307a9&tournament_id="+e.tournament_id+"&fields=teams",!1),n.send(),t[e.tournament_id]=JSON.parse(n.responseText).data[e.tournament_id].teams,t}),{}),dt=!1,ut=[],ht={},jt={},bt={},mt=[],ft=!1,pt=0;rt.data.map((function(t){ut.push(t.tournament_id),sessionStorage.setItem(t.tournament_id,!0)})),ht=rt.data.reduce((function(t,e){return-1!=mt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{width:19,height:21}):t[e.tournament_id]=Object(k.jsx)(D.a,{width:19,height:21}),t}),{}),jt=rt.data.reduce((function(t,e){return-1!=mt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{width:28,height:28}):t[e.tournament_id]=Object(k.jsx)(D.a,{}),t}),{}),bt=rt.data.reduce((function(t,e){return-1!=mt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{}):t[e.tournament_id]=Object(k.jsx)(D.a,{width:24,height:24}),t}),{});var Ot=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(t){var s;return Object(a.a)(this,n),(s=e.call(this,t)).state={activeModal:null,modalHistory:[],popout:null,snackbar:null,elem:null,bellsButtons:ht,bellsAndroid:jt,bellsIOS:bt},s.shareTargetRef=r.a.createRef(),s.sendPost=s.sendPost.bind(Object(u.a)(s)),s.shareLink=s.shareLink.bind(Object(u.a)(s)),s.closeActionSheet=function(){s.setState({popout:null})},s.modalBack=function(){s.setActiveModal(s.state.modalHistory[s.state.modalHistory.length-2]),history.back(),document.body.style.overflow="visible"},s}return Object(s.a)(n,[{key:"subscribeToNotification",value:function(t){var e,n=this;-1==mt.indexOf(t.tournament_id)?E(t).then((function(){mt.push(t.tournament_id),jt[t.tournament_id]=Object(k.jsx)(q.a,{width:28,height:28}),bt[t.tournament_id]=Object(k.jsx)(q.a,{}),ht[t.tournament_id]=Object(k.jsx)(q.a,{width:19,height:21}),n.setState({bellsAndroid:jt}),n.setState({bellsIOS:bt}),n.setState({bellsButtons:ht}),e=Object(k.jsx)(l.y,{onClose:function(){return n.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--green)"},children:Object(k.jsx)(C.a,{fill:"#fff",width:14,height:14})}),children:"\u0412\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u044b \u043e \u043d\u0430\u0447\u0430\u043b\u0435 \u0431\u043e\u0451\u0432 \u0442\u0443\u0440\u043d\u0438\u0440\u0430"}),n.setState({snackbar:e})})).catch((function(){e=Object(k.jsx)(l.y,{onClose:function(){return n.setState({snackbar:null})},duration:"1500",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--red)"},children:Object(k.jsx)(I.a,{fill:"#fff",width:14,height:14})}),children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0435 \u043d\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435"}),n.setState({snackbar:e})})):F(t).then((function(){mt.splice(mt.indexOf(t.tournament_id),1),jt[t.tournament_id]=Object(k.jsx)(D.a,{}),bt[t.tournament_id]=Object(k.jsx)(D.a,{width:24,height:24}),ht[t.tournament_id]=Object(k.jsx)(D.a,{width:19,height:21}),n.setState({bellsAndroid:jt}),n.setState({bellsIOS:bt}),n.setState({bellsButtons:ht})})).catch((function(){e=Object(k.jsx)(l.y,{onClose:function(){return n.setState({snackbar:null})},duration:"1500",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--red)"},children:Object(k.jsx)(I.a,{fill:"#fff",width:14,height:14})}),children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0438\u0441\u043a\u0435 \u043e\u0442 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),n.setState({snackbar:e})}))}},{key:"setActiveModal",value:function(t){t=t||null;var e=this.state.modalHistory?Object(d.a)(this.state.modalHistory):[];if(null===t?e=[]:-1!==e.indexOf(t)?e=e.splice(0,e.indexOf(t)+1):e.push(t),this.setState({activeModal:t,modalHistory:e}),null==this.state.activeModal){document.body.style.overflow="hidden",history.pushState({modal:"modal"},"")}}},{key:"buildRequest",value:function(t){return{message:'\u041d\u0430\u0447\u0430\u043b\u0430\u0441\u044c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u0430 \u0442\u0443\u0440\u043d\u0438\u0440 "'+t.title+'"\n\u041e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: '+S(t.registration_end_at,"dayAndTime")+"\n\u041d\u0430\u0447\u0430\u043b\u043e \u0431\u043e\u0435\u0432: "+S(t.start_at,"dayAndTime")+"\n\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043c\u043e\u0436\u043d\u043e \u0443\u0437\u043d\u0430\u0442\u044c \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438:",attachments:"https://vk.com/app7446072#"+t.tournament_id}}},{key:"sendPost",value:function(){var t=this,e=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--green)"},children:Object(k.jsx)(C.a,{fill:"#fff",width:14,height:14})}),children:"\u0417\u0430\u043f\u0438\u0441\u044c \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u0430"}),n=this.buildRequest(this.state.elem);B.a.send("VKWebAppShowWallPostBox",n).then((function(n){t.state.snackbar||t.setState({snackbar:e})}))}},{key:"shareLink",value:function(){var t=this,e=this.props.viewWidth>l.C.MOBILE,n=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--green)"},children:Object(k.jsx)(C.a,{fill:"#fff",width:14,height:14})}),children:e?"\u0421\u0441\u044b\u043b\u043a\u0430 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430":"\u0421\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430"}),a=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--red)"},children:Object(k.jsx)(I.a,{fill:"#fff",width:14,height:14})}),children:e?"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u0441\u044b\u043b\u043a\u0438":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0441\u0441\u044b\u043b\u043a\u0438"}),s="https://vk.com/app7446072#"+this.state.elem.tournament_id;e?B.a.send("VKWebAppCopyText",{text:s}).then((function(){t.state.snackbar||t.setState({snackbar:n})})).catch((function(){t.state.snackbar||t.setState({snackbar:a})})):B.a.send("VKWebAppShare",{link:s}).then((function(e){if(t.props.viewWidth>l.C.MOBILE){if(t.state.snackbar)return;t.setState({snackbar:n})}}))}},{key:"openShareActionSheet",value:function(t){var e=this;it=!1,ot=event.target.closest(".vkuiButton").getBoundingClientRect().height,at=event.target.closest(".vkuiButton").getBoundingClientRect().top,st=event.target.closest(".vkuiButton").getBoundingClientRect().left;var n=this.props.viewWidth>l.C.MOBILE;if(!n){var a={actionShet:t.tournament_id};history.pushState(a,"")}this.setState({elem:t}),this.setState({popout:Object(k.jsxs)(l.b,{onClose:function(){e.setState({popout:null}),n||history.back()},iosCloseItem:Object(k.jsx)(l.c,{autoclose:!0,mode:"cancel",children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),header:"\u041a\u0430\u043a \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u043c?",toggleRef:this.shareTargetRef.current,children:[Object(k.jsx)(l.c,{autoclose:!0,onClick:function(){return e.sendPost()},children:"\u041d\u0430 \u0441\u0442\u0435\u043d\u0435"}),Object(k.jsx)(l.c,{autoclose:!0,onClick:function(){return e.shareLink()},children:n?"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443"})]})})}},{key:"checkSubscriptions",value:function(){var t=this,e=new XMLHttpRequest;e.open("GET","https://wotbtournamentvkapp.ru/vkapp/activeSubscriptions".concat(window.location.search),!0),e.send(),e.onload=function(){try{mt=JSON.parse(e.responseText)}catch(n){console.log(n)}ht=rt.data.reduce((function(t,e){return-1!=mt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{width:19,height:21}):t[e.tournament_id]=Object(k.jsx)(D.a,{width:19,height:21}),t}),{}),jt=rt.data.reduce((function(t,e){return-1!=mt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{width:28,height:28}):t[e.tournament_id]=Object(k.jsx)(D.a,{}),t}),{}),bt=rt.data.reduce((function(t,e){return-1!=mt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{}):t[e.tournament_id]=Object(k.jsx)(D.a,{width:24,height:24}),t}),{}),t.setState({bellsAndroid:jt}),t.setState({bellsIOS:bt}),t.setState({bellsButtons:ht})}}},{key:"componentDidMount",value:function(){""==window.location.hash||dt||-1==ut.indexOf(Number(window.location.hash.slice(1)))||(this.setActiveModal(Number(window.location.hash.slice(1))),dt=!0),this.checkSubscriptions(),ct=(new Date).getTime()}},{key:"componentDidUpdate",value:function(){var t=document.getElementsByClassName("vkuiActionSheet--desktop");t[0]&&new MutationObserver((function(e){e&&!it&&(document.documentElement.clientHeight-at<200?at=at-t[0].getBoundingClientRect().height-5:at+=ot+5,t[0].style.top=at+"px",t[0].style.left=st+"px",it=!0)})).observe(t[0],{attributes:!0,attributeFilter:["style"]})}},{key:"render",value:function(){var t=this;window.addEventListener("scroll",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("orientationchange",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("focus",(function(){!ft&&pt<6&&(t.checkSubscriptions(),ft=!0,pt+=1,(new Date).getTime()-ct>2500&&(pt=0,ct=(new Date).getTime()),6==pt&&setTimeout((function(){pt=0}),3e4))})),window.addEventListener("blur",(function(){ft&&(ft=!1)})),window.addEventListener("popstate",(function(){null!=t.state.popout&&t.closeActionSheet(),null!=t.state.activeModal&&t.modalBack()}));var e=this.props.viewWidth>l.C.MOBILE,n=this.props.viewWidth<=l.C.MOBILE,a=this.props.platform;if(0!==rt.data.length)var s=Object(k.jsx)(l.p,{activeModal:this.state.activeModal,onClose:this.modalBack,children:rt.data.map((function(e){return Object(k.jsx)(l.n,{id:e.tournament_id,onClose:t.modalBack,header:Object(k.jsx)(l.o,{left:n&&a===l.m&&Object(k.jsx)(l.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsIOS[e.tournament_id]})||n&&a===l.a&&Object(k.jsx)(l.t,{onClick:t.modalBack}),right:n&&a===l.m&&Object(k.jsx)(l.s,{onClick:t.modalBack,children:Object(k.jsx)(A.a,{})})||n&&a===l.a&&Object(k.jsx)(l.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsAndroid[e.tournament_id]})||Object(k.jsx)(l.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsAndroid[e.tournament_id]}),children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),children:Object(k.jsxs)("div",{className:"ModalPage__Content Turnament-Information__Group",children:[Object(k.jsx)(l.k,{className:"vkuiGroup--custom-separator",children:Object(k.jsx)("h4",{children:e.title})}),Object(k.jsxs)(l.k,{className:"vkuiGroup--custom-separator",children:[Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0421\u0442\u0430\u0442\u0443\u0441"}),Object(k.jsx)("div",{style:{marginLeft:5},children:Object(k.jsx)("span",{style:{display:"inline-flex",alignItems:"center"},children:"\u0418\u0434\u0451\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(x.a,{width:17,height:17}),Object(k.jsx)(w,{timestamp:e.registration_start_at})]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(m.a,{width:17,height:17}),Object(k.jsx)(w,{timestamp:e.registration_end_at})]})]}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u043e\u0451\u0432"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(p.a,{width:17,height:17,style:{color:"green"}}),Object(k.jsx)(w,{timestamp:e.start_at})]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(p.a,{width:17,height:17,style:{color:"rgb(200, 0, 0)"}}),Object(k.jsx)(w,{timestamp:e.end_at})]})]}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)("span",{style:{fontWeight:"450"},children:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",lt[e.tournament_id].max]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)("span",{style:{fontWeight:"450"},children:"\u0421\u043e\u0437\u0434\u0430\u043d\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",lt[e.tournament_id].total]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)("span",{style:{fontWeight:"450"},children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u043b\u043e \u0443\u0447\u0430\u0441\u0442\u0438\u0435:\xa0"})," ",null==lt[e.tournament_id].confirmed?0:lt[e.tournament_id].confirmed]})]})]}),Object(k.jsx)(l.k,{className:"vkuiGroup--custom-separator",children:Object(k.jsx)("p",{className:"Pre",children:e.description})})]})})}))}),i=Object(k.jsxs)(l.v,{modal:s,popout:this.state.popout,children:[Object(k.jsx)(l.i,{size:e?"m":"l",children:rt.data.map((function(e){return Object(k.jsxs)(l.h,{mode:"outline",children:[Object(k.jsx)("div",{className:e.status+" border"}),Object(k.jsxs)("div",{className:"TournamentCard",children:[Object(k.jsx)("div",{className:"TournamentCard__Header",children:e.title}),Object(k.jsxs)("div",{className:"TornamentCard__Info",children:[Object(k.jsxs)("div",{className:"TornamentCard__Info-Start",children:[Object(k.jsx)(j.a,{width:23,height:23}),Object(k.jsx)("div",{className:"TornamentCard__Info-Start-Text",children:Object(k.jsx)(w,{timestamp:e.start_at,mode:"day"})})]}),Object(k.jsxs)("div",{className:"TournamentCard__Info-Main",children:[Object(k.jsxs)("div",{className:"TournamentCard__Info-Main-Registration",children:[Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex"},children:[Object(k.jsx)(x.a,{style:{paddingTop:"2.5px"},width:17,height:17}),Object(k.jsx)(w,{mode:"dayAndTime",timestamp:e.registration_start_at})]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex"},children:[Object(k.jsx)(m.a,{style:{paddingTop:"2.5px"},width:17,height:17}),Object(k.jsx)(w,{mode:"dayAndTime",timestamp:e.registration_end_at})]})]})]}),Object(k.jsxs)("div",{className:"TournamentCard__Info-Main-Start",children:[Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041d\u0430\u0447\u0430\u043b\u043e \u0431\u043e\u0451\u0432"}),Object(k.jsx)("div",{style:{marginLeft:5},children:Object(k.jsxs)("span",{style:{display:"inline-flex"},children:[Object(k.jsx)(p.a,{style:{paddingTop:"2.5px"},width:17,height:17}),Object(k.jsx)(w,Object(et.a)({mode:"dayAndTime",timestamp:e.start_at},"mode","dayAndTime"))]})})]})]})]}),Object(k.jsxs)("div",{className:"TornamentCard__Footer",children:[Object(k.jsx)(l.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-InfoButton",mode:"outline",before:Object(k.jsx)(y.a,{}),onClick:function(){return t.setActiveModal(e.tournament_id)},children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"}),Object(k.jsx)(l.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",getRootRef:t.shareTargetRef,onClick:function(){return t.openShareActionSheet(e)},children:Object(k.jsx)(g.a,{})}),Object(k.jsx)(l.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsButtons[e.tournament_id]})]})]})]})}))}),this.state.snackbar]});else if("none"==this.props.mode)i=Object(k.jsx)("span",{});else i=Object(k.jsx)(l.u,{children:"\u041d\u0435\u0442 \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u0432 \u0441 \u043d\u0430\u0447\u0430\u0432\u0448\u0435\u0439\u0441\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0435\u0439"});return i}}]),n}(r.a.Component),xt=Object(l.E)(Object(l.D)(Ot,{viewWidth:!0})),vt=new XMLHttpRequest;vt.open("POST","https://api.wotblitz.ru/wotb/tournaments/list/?application_id=132530213b8f23d4c0e1d1f423c307a9&status=registration_finished",!1),vt.send();var gt,_t,yt,kt,wt,St=JSON.parse(vt.responseText),Tt=St.data.reduce((function(t,e){var n=new XMLHttpRequest;return n.open("POST","https://api.wotblitz.ru/wotb/tournaments/info/?application_id=132530213b8f23d4c0e1d1f423c307a9&tournament_id="+e.tournament_id+"&fields=teams",!1),n.send(),t[e.tournament_id]=JSON.parse(n.responseText).data[e.tournament_id].teams,t}),{}),Ct=!1,Nt=[],It={},Mt={},Bt={},At=[],Lt=!1,Rt=0;St.data.map((function(t){Nt.push(t.tournament_id),sessionStorage.setItem(t.tournament_id,!0)})),It=St.data.reduce((function(t,e){return-1!=At.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{width:19,height:21}):t[e.tournament_id]=Object(k.jsx)(D.a,{width:19,height:21}),t}),{}),Mt=St.data.reduce((function(t,e){return-1!=At.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{width:28,height:28}):t[e.tournament_id]=Object(k.jsx)(D.a,{}),t}),{}),Bt=St.data.reduce((function(t,e){return-1!=At.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{}):t[e.tournament_id]=Object(k.jsx)(D.a,{width:24,height:24}),t}),{});var Et=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(t){var s;return Object(a.a)(this,n),(s=e.call(this,t)).state={activeModal:null,modalHistory:[],popout:null,snackbar:null,elem:null,bellsButtons:It,bellsAndroid:Mt,bellsIOS:Bt},s.sendPost=s.sendPost.bind(Object(u.a)(s)),s.shareTargetRef=r.a.createRef(),s.shareLink=s.shareLink.bind(Object(u.a)(s)),s.closeActionSheet=function(){s.setState({popout:null})},s.modalBack=function(){s.setActiveModal(s.state.modalHistory[s.state.modalHistory.length-2]),history.back(),document.body.style.overflow="visible"},s}return Object(s.a)(n,[{key:"subscribeToNotification",value:function(t){var e,n=this;-1==At.indexOf(t.tournament_id)?E(t).then((function(){At.push(t.tournament_id),Mt[t.tournament_id]=Object(k.jsx)(q.a,{width:28,height:28}),Bt[t.tournament_id]=Object(k.jsx)(q.a,{}),It[t.tournament_id]=Object(k.jsx)(q.a,{width:19,height:21}),n.setState({bellsAndroid:Mt}),n.setState({bellsIOS:Bt}),n.setState({bellsButtons:It}),e=Object(k.jsx)(l.y,{onClose:function(){return n.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--green)"},children:Object(k.jsx)(C.a,{fill:"#fff",width:14,height:14})}),children:"\u0412\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u044b \u043e \u043d\u0430\u0447\u0430\u043b\u0435 \u0431\u043e\u0451\u0432 \u0442\u0443\u0440\u043d\u0438\u0440\u0430"}),n.setState({snackbar:e})})).catch((function(){e=Object(k.jsx)(l.y,{onClose:function(){return n.setState({snackbar:null})},duration:"1500",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--red)"},children:Object(k.jsx)(I.a,{fill:"#fff",width:14,height:14})}),children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0435 \u043d\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435"}),n.setState({snackbar:e})})):F(t).then((function(){At.splice(At.indexOf(t.tournament_id),1),Mt[t.tournament_id]=Object(k.jsx)(D.a,{}),Bt[t.tournament_id]=Object(k.jsx)(D.a,{width:24,height:24}),It[t.tournament_id]=Object(k.jsx)(D.a,{width:19,height:21}),n.setState({bellsAndroid:Mt}),n.setState({bellsIOS:Bt}),n.setState({bellsButtons:It})})).catch((function(){e=Object(k.jsx)(l.y,{onClose:function(){return n.setState({snackbar:null})},duration:"1500",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--red)"},children:Object(k.jsx)(I.a,{fill:"#fff",width:14,height:14})}),children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0438\u0441\u043a\u0435 \u043e\u0442 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),n.state.snackbar||n.setState({snackbar:e})}))}},{key:"buildRequest",value:function(t){return{message:'\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u043b\u0430\u0441\u044c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u0430 \u0442\u0443\u0440\u043d\u0438\u0440 "'+t.title+'"\n\u041d\u0430\u0447\u0430\u043b\u043e \u0431\u043e\u0435\u0432: '+S(t.start_at)+"\n\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043c\u043e\u0436\u043d\u043e \u0443\u0437\u043d\u0430\u0442\u044c \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438:",attachments:"https://vk.com/app7446072#"+t.tournament_id}}},{key:"sendPost",value:function(){var t=this,e=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--green)"},children:Object(k.jsx)(C.a,{fill:"#fff",width:14,height:14})}),children:"\u0417\u0430\u043f\u0438\u0441\u044c \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u0430"}),n=this.buildRequest(this.state.elem);B.a.send("VKWebAppShowWallPostBox",n).then((function(n){t.state.snackbar||t.setState({snackbar:e})}))}},{key:"shareLink",value:function(){var t=this,e=this.props.viewWidth>l.C.MOBILE,n=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--green)"},children:Object(k.jsx)(C.a,{fill:"#fff",width:14,height:14})}),children:e?"\u0421\u0441\u044b\u043b\u043a\u0430 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430":"\u0421\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430"}),a=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--red)"},children:Object(k.jsx)(I.a,{fill:"#fff",width:14,height:14})}),children:e?"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u0441\u044b\u043b\u043a\u0438":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0441\u0441\u044b\u043b\u043a\u0438"}),s="https://vk.com/app7446072#"+this.state.elem.tournament_id;e?B.a.send("VKWebAppCopyText",{text:s}).then((function(){t.state.snackbar||t.setState({snackbar:n})})).catch((function(){t.state.snackbar||t.setState({snackbar:a})})):B.a.send("VKWebAppShare",{link:s}).then((function(e){if(t.props.viewWidth>l.C.MOBILE){if(t.state.snackbar)return;t.setState({snackbar:n})}}))}},{key:"openShareActionSheet",value:function(t){var e=this;yt=!1,kt=event.target.closest(".vkuiButton").getBoundingClientRect().height,gt=event.target.closest(".vkuiButton").getBoundingClientRect().top,_t=event.target.closest(".vkuiButton").getBoundingClientRect().left;var n=this.props.viewWidth>l.C.MOBILE;if(!n){var a={actionShet:t.tournament_id},s="";history.pushState(a,s)}if(!n){a={actionShet:t.tournament_id},s="";history.pushState(a,s)}this.setState({elem:t}),this.setState({popout:Object(k.jsxs)(l.b,{onClose:function(){e.setState({popout:null}),n||history.back()},iosCloseItem:Object(k.jsx)(l.c,{autoclose:!0,mode:"cancel",children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),header:"\u041a\u0430\u043a \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u043c?",toggleRef:this.shareTargetRef.current,children:[Object(k.jsx)(l.c,{autoclose:!0,onClick:function(){return e.sendPost()},children:"\u041d\u0430 \u0441\u0442\u0435\u043d\u0435"}),Object(k.jsx)(l.c,{autoclose:!0,onClick:function(){return e.shareLink()},children:n?"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443"})]})})}},{key:"setActiveModal",value:function(t){t=t||null;var e=this.state.modalHistory?Object(d.a)(this.state.modalHistory):[];if(null===t?e=[]:-1!==e.indexOf(t)?e=e.splice(0,e.indexOf(t)+1):e.push(t),this.setState({activeModal:t,modalHistory:e}),null==this.state.activeModal){document.body.style.overflow="hidden",history.pushState({modal:"modal"},"")}}},{key:"checkSubscriptions",value:function(){var t=this,e=new XMLHttpRequest;e.open("GET","https://wotbtournamentvkapp.ru/vkapp/activeSubscriptions".concat(window.location.search),!0),e.send(),e.onload=function(){try{At=JSON.parse(e.responseText)}catch(n){console.log(n)}It=St.data.reduce((function(t,e){return-1!=At.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{width:19,height:21}):t[e.tournament_id]=Object(k.jsx)(D.a,{width:19,height:21}),t}),{}),Mt=St.data.reduce((function(t,e){return-1!=At.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{width:28,height:28}):t[e.tournament_id]=Object(k.jsx)(D.a,{}),t}),{}),Bt=St.data.reduce((function(t,e){return-1!=At.indexOf(e.tournament_id)?t[e.tournament_id]=Object(k.jsx)(q.a,{}):t[e.tournament_id]=Object(k.jsx)(D.a,{width:24,height:24}),t}),{}),t.setState({bellsAndroid:Mt}),t.setState({bellsIOS:Bt}),t.setState({bellsButtons:It})}}},{key:"componentDidMount",value:function(){""==window.location.hash||Ct||-1==Nt.indexOf(Number(window.location.hash.slice(1)))||(this.setActiveModal(Number(window.location.hash.slice(1))),Ct=!0),this.checkSubscriptions(),wt=(new Date).getTime()}},{key:"componentDidUpdate",value:function(){var t=document.getElementsByClassName("vkuiActionSheet--desktop");t[0]&&new MutationObserver((function(e){e&&!yt&&(document.documentElement.clientHeight-gt<150?gt=gt-t[0].getBoundingClientRect().height-5:gt+=kt+5,t[0].style.top=gt+"px",t[0].style.left=_t+"px",yt=!0)})).observe(t[0],{attributes:!0,attributeFilter:["style"]})}},{key:"render",value:function(){var t=this;window.addEventListener("scroll",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("focus",(function(){!Lt&&Rt<6&&(t.checkSubscriptions(),Lt=!0,Rt+=1,(new Date).getTime()-wt>2500&&(Rt=0,wt=(new Date).getTime()),6==Rt&&setTimeout((function(){Rt=0}),3e4))})),window.addEventListener("blur",(function(){Lt&&(Lt=!1)})),window.addEventListener("orientationchange",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("popstate",(function(){null!=t.state.popout&&t.closeActionSheet(),null!=t.state.activeModal&&t.modalBack()}));var e=this.props.viewWidth>l.C.MOBILE,n=this.props.viewWidth<=l.C.MOBILE,a=this.props.platform;if(0!==St.data.length)var s=Object(k.jsx)(l.p,{activeModal:this.state.activeModal,onClose:this.modalBack,children:St.data.map((function(e){return Object(k.jsx)(l.n,{id:e.tournament_id,onClose:t.modalBack,header:Object(k.jsx)(l.o,{left:n&&a===l.m&&Object(k.jsx)(l.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsIOS[e.tournament_id]})||n&&a===l.a&&Object(k.jsx)(l.t,{onClick:t.modalBack}),right:n&&a===l.m&&Object(k.jsx)(l.s,{onClick:t.modalBack,children:Object(k.jsx)(A.a,{})})||n&&a===l.a&&Object(k.jsx)(l.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsAndroid[e.tournament_id]})||Object(k.jsx)(l.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsAndroid[e.tournament_id]}),children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),children:Object(k.jsxs)("div",{className:"ModalPage__Content Turnament-Information__Group",children:[Object(k.jsx)(l.k,{className:"vkuiGroup--custom-separator",children:Object(k.jsx)("h4",{children:e.title})}),Object(k.jsxs)(l.k,{className:"vkuiGroup--custom-separator",children:[Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0421\u0442\u0430\u0442\u0443\u0441"}),Object(k.jsx)("div",{style:{marginLeft:5},children:Object(k.jsx)("span",{style:{display:"inline-flex",alignItems:"center"},children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"})}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(x.a,{width:17,height:17}),Object(k.jsx)(w,{timestamp:e.registration_start_at})]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(m.a,{width:17,height:17}),Object(k.jsx)(w,{timestamp:e.registration_end_at})]})]}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u043e\u0451\u0432"}),Object(k.jsx)("div",{style:{marginLeft:5},children:Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(p.a,{width:17,height:17,style:{color:"green"}}),Object(k.jsx)(w,{timestamp:e.start_at})]})}),Object(k.jsx)("div",{style:{marginLeft:5},children:Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(p.a,{width:17,height:17,style:{color:"rgb(200, 0, 0)"}}),Object(k.jsx)(w,{timestamp:e.end_at})]})}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)("span",{style:{fontWeight:"450"},children:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",Tt[e.tournament_id].max]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)("span",{style:{fontWeight:"450"},children:"\u0421\u043e\u0437\u0434\u0430\u043d\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",Tt[e.tournament_id].total]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)("span",{style:{fontWeight:"450"},children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u043b\u043e \u0443\u0447\u0430\u0441\u0442\u0438\u0435:\xa0"})," ",Tt[e.tournament_id].confirmed]})]})]}),Object(k.jsx)(l.k,{className:"vkuiGroup--custom-separator",children:Object(k.jsx)("p",{className:"Pre",children:e.description})})]})})}))}),i=Object(k.jsxs)(l.v,{modal:s,popout:this.state.popout,children:[Object(k.jsx)(l.i,{size:e?"m":"l",children:St.data.map((function(e){return Object(k.jsxs)(l.h,{mode:"outline",children:[Object(k.jsx)("div",{className:e.status+" border"}),Object(k.jsxs)("div",{className:"TournamentCard",children:[Object(k.jsx)("div",{className:"TournamentCard__Header",children:e.title}),Object(k.jsxs)("div",{className:"TornamentCard__Info",children:[Object(k.jsxs)("div",{className:"TornamentCard__Info-Start",children:[Object(k.jsx)(j.a,{width:23,height:23}),Object(k.jsx)("div",{className:"TornamentCard__Info-Start-Text",children:Object(k.jsx)(w,{timestamp:e.start_at,mode:"day"})})]}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main TournamentCard__Info-Main-OneItem",children:Object(k.jsxs)("div",{className:"TournamentCard__Info-Main-Start",children:[Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041d\u0430\u0447\u0430\u043b\u043e \u0431\u043e\u0451\u0432"}),Object(k.jsx)("div",{style:{marginLeft:5},children:Object(k.jsxs)("span",{style:{display:"inline-flex"},children:[Object(k.jsx)(x.a,{style:{paddingTop:"2.5px"},width:17,height:17}),Object(k.jsx)(w,{mode:"dayAndTime",timestamp:e.start_at})]})})]})})]}),Object(k.jsxs)("div",{className:"TornamentCard__Footer",children:[Object(k.jsx)(l.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-InfoButton",mode:"outline",before:Object(k.jsx)(y.a,{}),onClick:function(){return t.setActiveModal(e.tournament_id)},children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"}),Object(k.jsx)(l.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",getRootRef:t.shareTargetRef,onClick:function(){return t.openShareActionSheet(e)},children:Object(k.jsx)(g.a,{})}),Object(k.jsx)(l.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsButtons[e.tournament_id]})]})]})]})}))}),this.state.snackbar]});else if("none"==this.props.mode)i=Object(k.jsx)("span",{});else i=Object(k.jsx)(l.u,{children:"\u041d\u0435\u0442 \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u0432 \u0441 \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d\u043d\u043e\u0439 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0435\u0439"});return i}}]),n}(r.a.Component),Wt=Object(l.E)(Object(l.D)(Et,{viewWidth:!0})),Ht=new XMLHttpRequest;Ht.open("POST","https://api.wotblitz.ru/wotb/tournaments/list/?application_id=132530213b8f23d4c0e1d1f423c307a9&status=running",!1),Ht.send();var Pt,zt,Ft,Dt,qt=JSON.parse(Ht.responseText),Gt=qt.data.reduce((function(t,e){var n=new XMLHttpRequest;return n.open("POST","https://api.wotblitz.ru/wotb/tournaments/info/?application_id=132530213b8f23d4c0e1d1f423c307a9&tournament_id="+e.tournament_id+"&fields=teams",!1),n.send(),t[e.tournament_id]=JSON.parse(n.responseText).data[e.tournament_id].teams,t}),{}),Jt=!1,Kt=[];qt.data.map((function(t){Kt.push(t.tournament_id),sessionStorage.setItem(t.tournament_id,!0)}));var Vt=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(t){var s;return Object(a.a)(this,n),(s=e.call(this,t)).state={activeModal:null,modalHistory:[],popout:null,snackbar:null,elem:null},s.shareTargetRef=r.a.createRef(),s.sendPost=s.sendPost.bind(Object(u.a)(s)),s.shareLink=s.shareLink.bind(Object(u.a)(s)),s.closeActionSheet=function(){s.setState({popout:null})},s.modalBack=function(){s.setActiveModal(s.state.modalHistory[s.state.modalHistory.length-2]),history.back(),document.body.style.overflow="visible"},s}return Object(s.a)(n,[{key:"setActiveModal",value:function(t){t=t||null;var e=this.state.modalHistory?Object(d.a)(this.state.modalHistory):[];if(null===t?e=[]:-1!==e.indexOf(t)?e=e.splice(0,e.indexOf(t)+1):e.push(t),this.setState({activeModal:t,modalHistory:e}),null==this.state.activeModal){document.body.style.overflow="hidden",history.pushState({modal:"modal"},"")}}},{key:"buildRequest",value:function(t){return{message:'\u041d\u0430\u0447\u0430\u043b\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440 "'+t.title+'"\n\u041e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u0435 \u0431\u043e\u0435\u0432: '+S(t.end_at,"dayAndTime")+"\n\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043c\u043e\u0436\u043d\u043e \u0443\u0437\u043d\u0430\u0442\u044c \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438:",attachments:"https://vk.com/app7446072#"+t.tournament_id}}},{key:"sendPost",value:function(){var t=this,e=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--green)"},children:Object(k.jsx)(C.a,{fill:"#fff",width:14,height:14})}),children:"\u0417\u0430\u043f\u0438\u0441\u044c \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u0430"}),n=this.buildRequest(this.state.elem);B.a.send("VKWebAppShowWallPostBox",n).then((function(n){t.state.snackbar||t.setState({snackbar:e})}))}},{key:"shareLink",value:function(){var t=this,e=this.props.viewWidth>l.C.MOBILE,n=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--green)"},children:Object(k.jsx)(C.a,{fill:"#fff",width:14,height:14})}),children:e?"\u0421\u0441\u044b\u043b\u043a\u0430 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430":"\u0421\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430"}),a=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--red)"},children:Object(k.jsx)(I.a,{fill:"#fff",width:14,height:14})}),children:e?"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u0441\u044b\u043b\u043a\u0438":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0441\u0441\u044b\u043b\u043a\u0438"}),s="https://vk.com/app7446072#"+this.state.elem.tournament_id;e?B.a.send("VKWebAppCopyText",{text:s}).then((function(){t.state.snackbar||t.setState({snackbar:n})})).catch((function(){t.state.snackbar||t.setState({snackbar:a})})):B.a.send("VKWebAppShare",{link:s}).then((function(e){if(t.props.viewWidth>l.C.MOBILE){if(t.state.snackbar)return;t.setState({snackbar:n})}}))}},{key:"openShareActionSheet",value:function(t){var e=this;Ft=!1,Dt=event.target.closest(".vkuiButton").getBoundingClientRect().height,Pt=event.target.closest(".vkuiButton").getBoundingClientRect().top,zt=event.target.closest(".vkuiButton").getBoundingClientRect().left;var n=this.props.viewWidth>l.C.MOBILE;if(!n){var a={actionShet:t.tournament_id};history.pushState(a,"")}this.setState({elem:t}),this.setState({popout:Object(k.jsxs)(l.b,{onClose:function(){e.setState({popout:null}),n||history.back()},iosCloseItem:Object(k.jsx)(l.c,{autoclose:!0,mode:"cancel",children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),header:"\u041a\u0430\u043a \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u043c?",toggleRef:this.shareTargetRef.current,children:[Object(k.jsx)(l.c,{autoclose:!0,onClick:function(){return e.sendPost()},children:"\u041d\u0430 \u0441\u0442\u0435\u043d\u0435"}),Object(k.jsx)(l.c,{autoclose:!0,onClick:function(){return e.shareLink()},children:n?"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443"})]})})}},{key:"componentDidMount",value:function(){""==window.location.hash||Jt||-1==Kt.indexOf(Number(window.location.hash.slice(1)))||(this.setActiveModal(Number(window.location.hash.slice(1))),Jt=!0)}},{key:"componentDidUpdate",value:function(){var t=document.getElementsByClassName("vkuiActionSheet--desktop");t[0]&&new MutationObserver((function(e){e&&!Ft&&(document.documentElement.clientHeight-Pt<200?Pt=Pt-t[0].getBoundingClientRect().height-5:Pt+=Dt+5,t[0].style.top=Pt+"px",t[0].style.left=zt+"px",Ft=!0)})).observe(t[0],{attributes:!0,attributeFilter:["style"]})}},{key:"render",value:function(){var t=this;window.addEventListener("scroll",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("orientationchange",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("popstate",(function(){null!=t.state.popout&&t.closeActionSheet(),null!=t.state.activeModal&&t.modalBack()}));var e=this.props.viewWidth>l.C.MOBILE,n=this.props.viewWidth<=l.C.MOBILE,a=this.props.platform;if(0!==qt.data.length)var s=Object(k.jsx)(l.p,{activeModal:this.state.activeModal,onClose:this.modalBack,children:qt.data.map((function(e){return Object(k.jsx)(l.n,{id:e.tournament_id,onClose:t.modalBack,header:Object(k.jsx)(l.o,{right:n&&a==l.m&&Object(k.jsx)(l.s,{onClick:t.modalBack,children:Object(k.jsx)(A.a,{})}),left:n&&a===l.a&&Object(k.jsx)(l.t,{onClick:t.modalBack}),children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),children:Object(k.jsxs)("div",{className:"ModalPage__Content Turnament-Information__Group",children:[Object(k.jsx)(l.k,{className:"vkuiGroup--custom-separator",children:Object(k.jsx)("h4",{children:e.title})}),Object(k.jsxs)(l.k,{className:"vkuiGroup--custom-separator",children:[Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0421\u0442\u0430\u0442\u0443\u0441"}),Object(k.jsx)("div",{style:{marginLeft:5},children:Object(k.jsx)("span",{style:{display:"inline-flex",alignItems:"center"},children:"\u0418\u0434\u0443\u0442 \u0431\u043e\u0438"})}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(x.a,{width:17,height:17}),Object(k.jsx)(w,{timestamp:e.registration_start_at})]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(m.a,{width:17,height:17}),Object(k.jsx)(w,{timestamp:e.registration_end_at})]})]}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u043e\u0451\u0432"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(p.a,{width:17,height:17,style:{color:"green"}}),Object(k.jsx)(w,{timestamp:e.start_at})]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(p.a,{width:17,height:17,style:{color:"rgb(200, 0, 0)"}}),Object(k.jsx)(w,{timestamp:e.end_at})]})]}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)("span",{style:{fontWeight:"450"},children:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",Gt[e.tournament_id].max]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)("span",{style:{fontWeight:"450"},children:"\u0421\u043e\u0437\u0434\u0430\u043d\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",Gt[e.tournament_id].total]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)("span",{style:{fontWeight:"450"},children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u043b\u043e \u0443\u0447\u0430\u0441\u0442\u0438\u0435:\xa0"})," ",Gt[e.tournament_id].confirmed]})]})]}),Object(k.jsx)(l.k,{className:"vkuiGroup--custom-separator",children:Object(k.jsx)("p",{className:"Pre",children:e.description})})]})})}))}),i=Object(k.jsxs)(l.v,{modal:s,popout:this.state.popout,children:[Object(k.jsx)(l.i,{size:e?"m":"l",children:qt.data.map((function(e){return Object(k.jsxs)(l.h,{mode:"outline",children:[Object(k.jsx)("div",{className:e.status+" border"}),Object(k.jsxs)("div",{className:"TournamentCard",children:[Object(k.jsx)("div",{className:"TournamentCard__Header",children:e.title}),Object(k.jsxs)("div",{className:"TornamentCard__Info",children:[Object(k.jsxs)("div",{className:"TornamentCard__Info-Start",children:[Object(k.jsx)(j.a,{width:23,height:23}),Object(k.jsx)("div",{className:"TornamentCard__Info-Start-Text",children:Object(k.jsx)(w,{timestamp:e.start_at,mode:"day"})})]}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main TournamentCard__Info-Main-OneItem",children:Object(k.jsxs)("div",{className:"TournamentCard__Info-Main-Start",children:[Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u043e\u0451\u0432"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex"},children:[Object(k.jsx)(x.a,{style:{paddingTop:"2.5px"},width:17,height:17}),Object(k.jsx)(w,{mode:"dayAndTime",timestamp:e.start_at})]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex"},children:[Object(k.jsx)(m.a,{style:{paddingTop:"2.5px"},width:17,height:17}),Object(k.jsx)(w,{mode:"dayAndTime",timestamp:e.end_at})]})]})]})})]}),Object(k.jsxs)("div",{className:"TornamentCard__Footer",children:[Object(k.jsx)(l.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-InfoButton",mode:"outline",before:Object(k.jsx)(y.a,{}),onClick:function(){return t.setActiveModal(e.tournament_id)},children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"}),Object(k.jsx)(l.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",getRootRef:t.shareTargetRef,onClick:function(){return t.openShareActionSheet(e)},children:Object(k.jsx)(g.a,{})})]})]})]})}))}),this.state.snackbar]});else if("none"==this.props.mode)i=Object(k.jsx)("span",{});else i=Object(k.jsx)(l.u,{children:"\u041d\u0435\u0442 \u043d\u0430\u0447\u0430\u0432\u0448\u0438\u0445\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u0432"});return i}}]),n}(r.a.Component),Xt=Object(l.E)(Object(l.D)(Vt,{viewWidth:!0})),Ut=new XMLHttpRequest;Ut.open("POST","https://api.wotblitz.ru/wotb/tournaments/list/?application_id=132530213b8f23d4c0e1d1f423c307a9&status=finished",!1),Ut.send();var Zt,Yt,Qt,$t,te=JSON.parse(Ut.responseText),ee=te.data.reduce((function(t,e){var n=new XMLHttpRequest;return n.open("POST","https://api.wotblitz.ru/wotb/tournaments/info/?application_id=132530213b8f23d4c0e1d1f423c307a9&tournament_id="+e.tournament_id+"&fields=teams",!1),n.send(),t[e.tournament_id]=JSON.parse(n.responseText).data[e.tournament_id].teams,t}),{}),ne=!1,ae=[];te.data.map((function(t){ae.push(t.tournament_id),sessionStorage.setItem(t.tournament_id,!0)}));var se=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(t){var s;return Object(a.a)(this,n),(s=e.call(this,t)).state={activeModal:null,modalHistory:[],popout:null,snackbar:null,elem:null},s.shareTargetRef=r.a.createRef(),s.sendPost=s.sendPost.bind(Object(u.a)(s)),s.shareLink=s.shareLink.bind(Object(u.a)(s)),s.closeActionSheet=function(){s.setState({popout:null})},s.modalBack=function(){s.setActiveModal(s.state.modalHistory[s.state.modalHistory.length-2]),history.back(),document.body.style.overflow="visible"},s}return Object(s.a)(n,[{key:"buildRequest",value:function(t){return{message:S(t.end_at,"day")+' \u043f\u0440\u043e\u0448\u0435\u043b \u0442\u0443\u0440\u043d\u0438\u0440 "'+t.title+'"\n\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043c\u043e\u0436\u043d\u043e \u0443\u0437\u043d\u0430\u0442\u044c \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438:',attachments:"https://vk.com/app7446072#"+t.tournament_id}}},{key:"sendPost",value:function(){var t=this,e=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--green)"},children:Object(k.jsx)(C.a,{fill:"#fff",width:14,height:14})}),children:"\u0417\u0430\u043f\u0438\u0441\u044c \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u0430"}),n=this.buildRequest(this.state.elem);B.a.send("VKWebAppShowWallPostBox",n).then((function(n){t.state.snackbar||t.setState({snackbar:e})}))}},{key:"shareLink",value:function(){var t=this,e=this.props.viewWidth>l.C.MOBILE,n=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--green)"},children:Object(k.jsx)(C.a,{fill:"#fff",width:14,height:14})}),children:e?"\u0421\u0441\u044b\u043b\u043a\u0430 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430":"\u0421\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430"}),a=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--red)"},children:Object(k.jsx)(I.a,{fill:"#fff",width:14,height:14})}),children:e?"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u0441\u044b\u043b\u043a\u0438":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0441\u0441\u044b\u043b\u043a\u0438"}),s="https://vk.com/app7446072#"+this.state.elem.tournament_id;e?B.a.send("VKWebAppCopyText",{text:s}).then((function(){t.state.snackbar||t.setState({snackbar:n})})).catch((function(){t.state.snackbar||t.setState({snackbar:a})})):B.a.send("VKWebAppShare",{link:s}).then((function(e){if(t.props.viewWidth>l.C.MOBILE){if(t.state.snackbar)return;t.setState({snackbar:n})}}))}},{key:"openShareActionSheetFinish",value:function(t){var e=this;Qt=!1,$t=event.target.closest(".vkuiButton").getBoundingClientRect().height,Zt=event.target.closest(".vkuiButton").getBoundingClientRect().top,Yt=event.target.closest(".vkuiButton").getBoundingClientRect().left;var n=this.props.viewWidth>l.C.MOBILE;if(!n){var a={actionShet:t.tournament_id};history.pushState(a,"")}this.setState({elem:t}),this.setState({popout:Object(k.jsxs)(l.b,{onClose:function(){e.setState({popout:null}),n||history.back()},iosCloseItem:Object(k.jsx)(l.c,{autoclose:!0,mode:"cancel",children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),header:"\u041a\u0430\u043a \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u043c?",toggleRef:this.shareTargetRef.current,children:[Object(k.jsx)(l.c,{autoclose:!0,onClick:function(){return e.sendPost()},children:"\u041d\u0430 \u0441\u0442\u0435\u043d\u0435"}),Object(k.jsx)(l.c,{autoclose:!0,onClick:function(){return e.shareLink()},children:n?"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443"})]})})}},{key:"setActiveModal",value:function(t){t=t||null;var e=this.state.modalHistory?Object(d.a)(this.state.modalHistory):[];if(null===t?e=[]:-1!==e.indexOf(t)?e=e.splice(0,e.indexOf(t)+1):e.push(t),this.setState({activeModal:t,modalHistory:e}),null==this.state.activeModal){document.body.style.overflow="hidden",history.pushState({modal:"modal"},"")}}},{key:"componentDidMount",value:function(){""==window.location.hash||ne||-1==ae.indexOf(Number(window.location.hash.slice(1)))||(this.setActiveModal(Number(window.location.hash.slice(1))),ne=!0)}},{key:"componentDidUpdate",value:function(){var t=document.getElementsByClassName("vkuiActionSheet--desktop");t[0]&&new MutationObserver((function(e){e&&!Qt&&(document.documentElement.clientHeight-Zt<200?Zt=Zt-t[0].getBoundingClientRect().height-5:Zt+=$t+5,t[0].style.top=Zt+"px",t[0].style.left=Yt+"px",Qt=!0)})).observe(t[0],{attributes:!0,attributeFilter:["style"]})}},{key:"render",value:function(){var t=this;window.addEventListener("scroll",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("orientationchange",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("popstate",(function(){null!=t.state.popout&&t.closeActionSheet(),null!=t.state.activeModal&&t.modalBack()}));var e=this.props.viewWidth>l.C.MOBILE,n=this.props.viewWidth<=l.C.MOBILE,a=this.props.platform;if(0!==te.data.length)var s=Object(k.jsx)(l.p,{activeModal:this.state.activeModal,onClose:this.modalBack,children:te.data.map((function(e){return Object(k.jsx)(l.n,{id:e.tournament_id,onClose:t.modalBack,header:Object(k.jsx)(l.o,{right:n&&a===l.m&&Object(k.jsx)(l.s,{onClick:t.modalBack,children:Object(k.jsx)(A.a,{})}),left:n&&a===l.a&&Object(k.jsx)(l.t,{onClick:t.modalBack}),children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),children:Object(k.jsxs)("div",{className:"ModalPage__Content Turnament-Information__Group",children:[Object(k.jsx)(l.k,{className:"vkuiGroup--custom-separator",children:Object(k.jsx)("h4",{children:e.title})}),Object(k.jsxs)(l.k,{className:"vkuiGroup--custom-separator",children:[Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0421\u0442\u0430\u0442\u0443\u0441"}),Object(k.jsx)("div",{style:{marginLeft:5},children:Object(k.jsx)("span",{style:{display:"inline-flex",alignItems:"center"},children:"\u0422\u0443\u0440\u043d\u0438\u0440 \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d"})}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(x.a,{width:17,height:17}),Object(k.jsx)(w,{timestamp:e.registration_start_at})]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(m.a,{width:17,height:17}),Object(k.jsx)(w,{timestamp:e.registration_end_at})]})]}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u043e\u0451\u0432"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(p.a,{width:17,height:17,style:{color:"green"}}),Object(k.jsx)(w,{timestamp:e.start_at})]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)(p.a,{width:17,height:17,style:{color:"rgb(200, 0, 0)"}}),Object(k.jsx)(w,{timestamp:e.end_at})]})]}),Object(k.jsx)("br",{}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"}),Object(k.jsxs)("div",{style:{marginLeft:5},children:[Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)("span",{style:{fontWeight:"450"},children:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",ee[e.tournament_id].max]}),Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(k.jsx)("span",{style:{fontWeight:"450"},children:"\u041f\u0440\u0438\u043d\u044f\u043b\u043e \u0443\u0447\u0430\u0441\u0442\u0438\u0435:\xa0"})," ",ee[e.tournament_id].total]})]})]}),Object(k.jsx)(l.k,{className:"vkuiGroup--custom-separator",children:Object(k.jsx)("p",{className:"Pre",children:e.description})})]})})}))}),i=Object(k.jsxs)(l.v,{modal:s,popout:this.state.popout,children:[Object(k.jsx)(l.i,{size:e?"m":"l",children:te.data.map((function(e){return Object(k.jsxs)(l.h,{mode:"outline",children:[Object(k.jsx)("div",{className:e.status+" border"}),Object(k.jsxs)("div",{className:"TournamentCard",children:[Object(k.jsx)("div",{className:"TournamentCard__Header",children:e.title}),Object(k.jsxs)("div",{className:"TornamentCard__Info",children:[Object(k.jsxs)("div",{className:"TornamentCard__Info-Start",children:[Object(k.jsx)(j.a,{width:23,height:23}),Object(k.jsx)("div",{className:"TornamentCard__Info-Start-Text",children:Object(k.jsx)(w,{timestamp:e.start_at,mode:"day"})})]}),Object(k.jsx)("div",{className:"TournamentCard__Info-Main",children:"\u0422\u0443\u0440\u043d\u0438\u0440 \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d"})]}),Object(k.jsxs)("div",{className:"TornamentCard__Footer",children:[Object(k.jsx)(l.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-InfoButton",mode:"outline",before:Object(k.jsx)(y.a,{}),onClick:function(){return t.setActiveModal(e.tournament_id)},children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"}),Object(k.jsx)(l.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",getRootRef:t.shareTargetRef,onClick:function(){return t.openShareActionSheetFinish(e)},children:Object(k.jsx)(g.a,{})})]})]})]})}))}),this.state.snackbar]});else if("none"==this.props.mode)i=Object(k.jsx)("span",{});else i=Object(k.jsx)(l.u,{children:"\u041d\u0435\u0442 \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d\u043d\u044b\u0445 \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u0432"});return i}}]),n}(r.a.Component),ie=Object(l.E)(Object(l.D)(se,{viewWidth:!0})),oe=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(){return Object(a.a)(this,n),e.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return Object(k.jsxs)("div",{children:[Object(k.jsx)(xt,{mode:"none"}),Object(k.jsx)(tt,{mode:"none"}),Object(k.jsx)(Wt,{mode:"none"}),Object(k.jsx)(Xt,{mode:"none"}),Object(k.jsx)(ie,{mode:"none"})]})}}]),n}(r.a.Component),ce=!1,re=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(t){var s;return Object(a.a)(this,n),(s=e.call(this,t)).state={contextOpened:!1,mode:"all",activeTab:"all",snackbar:null},s}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;if(""!=window.location.hash&&!ce&&!sessionStorage.getItem(window.location.hash.slice(1))){var e=Object(k.jsx)(l.y,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--red)"},children:Object(k.jsx)(I.a,{fill:"#fff",width:14,height:14})}),children:"\u041d\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0442\u0443\u0440\u043d\u0438\u0440\u0435"});this.setState({snackbar:e}),ce=!0}}},{key:"render",value:function(){var t,e=this,n=this.props.viewWidth>l.C.MOBILE;return B.a.subscribe((function(t){if("VKWebAppDenyNotificationsResult"===t.detail.type){var n=Object(k.jsxs)(l.y,{onClose:function(){return e.setState({snackbar:null})},duration:"2500",before:Object(k.jsx)(l.f,{size:24,style:{background:"var(--red)"},children:Object(k.jsx)(I.a,{fill:"#fff",width:14,height:14})}),children:["\u0412\u044b \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u043b\u0438 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043e\u0442 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f ",Object(k.jsx)("br",{})," \u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043e \u043d\u0443\u0436\u043d\u044b\u0445 \u0442\u0443\u0440\u043d\u0438\u0440\u0430\u0445 \u043d\u0435 \u043f\u0440\u0438\u0434\u0443\u0442"]});e.setState({snackbar:n})}})),n&&(window.onfocus=function(t){var e=window.scrollX,n=window.scrollY;document.body.style.height="105%",window.scroll(e,n+5),window.scroll(e,n-5),document.body.style.height="100%"}),"all"===this.state.activeTab&&(t=Object(k.jsx)(oe,{})),"upcoming"===this.state.activeTab&&(t=Object(k.jsx)(tt,{})),"registration_started"===this.state.activeTab&&(t=Object(k.jsx)(xt,{})),"registration_finished"===this.state.activeTab&&(t=Object(k.jsx)(Wt,{})),"running"===this.state.activeTab&&(t=Object(k.jsx)(Xt,{})),"finish"===this.state.activeTab&&(t=Object(k.jsx)(ie,{})),Object(k.jsxs)("span",{children:[Object(k.jsx)(l.r,{children:"T\u0443\u0440\u043d\u0438\u0440\u044b WoT Blitz"}),Object(k.jsxs)(l.k,{style:{paddingTop:40},children:[Object(k.jsxs)(l.j,{vertical:"top",filled:!0,children:[Object(k.jsx)(l.z,{children:Object(k.jsxs)(l.l,{showArrows:!0,getScrollToLeft:function(t){return t-120},getScrollToRight:function(t){return t+120},children:[Object(k.jsx)(l.A,{onClick:function(){e.setState({activeTab:"all"}),window.scrollTo(0,0)},selected:"all"===this.state.activeTab,children:"\u0412\u0441\u0435"}),Object(k.jsx)(l.A,{onClick:function(){e.setState({activeTab:"registration_started"}),window.scrollTo(0,0)},selected:"registration_started"===this.state.activeTab,children:"\u0418\u0434\u0451\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(k.jsx)(l.A,{onClick:function(){e.setState({activeTab:"upcoming"}),window.scrollTo(0,0)},selected:"upcoming"===this.state.activeTab,children:"\u0417\u0430\u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435"}),Object(k.jsx)(l.A,{onClick:function(){e.setState({activeTab:"registration_finished"}),window.scrollTo(0,0)},selected:"registration_finished"===this.state.activeTab,children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"}),Object(k.jsx)(l.A,{onClick:function(){e.setState({activeTab:"running"}),window.scrollTo(0,0)},selected:"running"===this.state.activeTab,children:"\u0418\u0434\u0443\u0442 \u0431\u043e\u0438"}),Object(k.jsx)(l.A,{onClick:function(){e.setState({activeTab:"finish"}),window.scrollTo(0,0)},selected:"finish"===this.state.activeTab,children:"\u0411\u043e\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u044b"})]})}),Object(k.jsx)(l.x,{wide:!0})]}),t,this.state.snackbar]})]})}}]),n}(r.a.Component);e.default=Object(l.E)((function(){return Object(k.jsx)(re,{})}))}}]);
//# sourceMappingURL=5.54b62f62.chunk.js.map