(this.webpackJsonptournemnt=this.webpackJsonptournemnt||[]).push([[0],{278:function(t,e,n){},279:function(t,e,n){"use strict";n.r(e);n(183),n(210),n(212),n(213),n(215),n(216),n(217),n(218),n(219),n(220),n(221),n(222),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(235),n(236),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252);var s=n(2),a=n.n(s),i=n(61),c=n.n(i),r=n(11),o=n.n(r),l=(n(260),n(29)),d=n(30),u=n(32),j=n(31),h=n(1),b=n(43),m=n(23),f=n(40),O=n.n(f),x=n(35),p=n.n(x),v=n(24),g=n.n(v),_=n(33),k=n.n(_),y=n(42),w=n.n(y),S=n(41),T=n.n(S),C=n(0);var B=function(t){var e=new Date(1e3*t.timestamp),n=e.getHours(),s=e.getMinutes(),a=e.getDate(),i=e.getMonth()+1,c=e.getFullYear(),r=i;switch(s<10&&(s="0"+s),i<10&&(r="0"+i),a<10&&(a="0"+a),t.mode){case"day":return Object(C.jsx)("span",{children:a+" "+["default","\u044f\u043d\u0432\u0430\u0440\u044f","\u0444\u0435\u0432\u0440\u0430\u043b\u044f","\u043c\u0430\u0440\u0442\u0430","\u0430\u043f\u0440\u0435\u043b\u044f","\u043c\u0430\u044f","\u0438\u044e\u043d\u044f","\u0438\u044e\u043b\u044f","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u043e\u043a\u0442\u044f\u0431\u0440\u044f","\u043d\u043e\u044f\u0431\u0440\u044f","\u0434\u0435\u043a\u0430\u0431\u0440\u044f"][i]+" "+c});case"time":return Object(C.jsx)("span",{children:n+":"+s});case"dayAndTime":return Object(C.jsx)("span",{children:a+"."+r+", "+n+":"+s});default:return Object(C.jsx)("span",{children:a+"."+r+"."+c+", "+n+":"+s})}};var I=function(t,e){var n=new Date(1e3*t);switch(e){case"day":var s={year:"numeric",month:"long",day:"numeric",timeZone:"UTC"};return n.toLocaleDateString("ru-RU",s)+" (UTC)";case"time":s={hour:"numeric",minute:"numeric",timeZone:"UTC"};return n.toLocaleDateString("ru-RU",s)+" (UTC)";case"dayAndTime":s={month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",timeZone:"UTC"};return n.toLocaleDateString("ru-RU",s)+" (UTC)";default:s={month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",timeZone:"UTC"};return n.toLocaleDateString("ru-RU",s)+" (UTC)"}},N=n(22),M=n.n(N),L=n(21),A=n.n(L),R=n(282),W=(new Date).getTime(),E=[];var H=function(t){return new Promise((function(e,n){(new Date).getTime()-W>1500&&-1==E.indexOf(t.tournament_id)&&(W=(new Date).getTime(),E.push(t.tournament_id),o.a.send("VKWebAppAllowNotifications").then((function(){var s="https://wotbtournamentvkapp.ru/vkapp/subscribe".concat(window.location.search,"&tournament_id=").concat(t.tournament_id),a=new XMLHttpRequest;a.open("GET",s,!0),a.send(),a.onload=function(){E.splice(E.indexOf(t.tournament_id),1);try{200==JSON.parse(a.responseText)||300==JSON.parse(a.responseText)?e():n()}catch(s){n()}},a.onerror=function(){n()}})).catch((function(){E.splice(E.indexOf(t.tournament_id),1)})))}))};var P,z,F,D=function(t){return new Promise((function(e,n){var s="https://wotbtournamentvkapp.ru/vkapp/unsubscribe".concat(window.location.search,"&tournament_id=").concat(t.tournament_id),a=new XMLHttpRequest;a.open("GET",s,!0),a.send(),a.onload=function(){try{200==JSON.parse(a.responseText)?e():n()}catch(t){n()}},a.onerror=function(){n()}}))},V=n(281),q=n(280),G=!1;o.a.subscribe((function(t){"VKWebAppViewRestore"===t.detail.type&&(G=!0)})),G||((P=new XMLHttpRequest).open("POST","https://api.wotblitz.ru/wotb/tournaments/list/?application_id=132530213b8f23d4c0e1d1f423c307a9&status=upcoming",!1),P.send(),z=JSON.parse(P.responseText),F=z.data.reduce((function(t,e){var n=new XMLHttpRequest;return n.open("POST","https://api.wotblitz.ru/wotb/tournaments/info/?application_id=132530213b8f23d4c0e1d1f423c307a9&tournament_id="+e.tournament_id+"&fields=teams",!1),n.send(),t[e.tournament_id]=JSON.parse(n.responseText).data[e.tournament_id].teams,t}),{}));var K,J,U,X,Z,Y=!1,Q=[],$={},tt={},et={},nt=[],st=!1,at=0;z.data.map((function(t){Q.push(t.tournament_id),sessionStorage.setItem(t.tournament_id,!0)})),$=z.data.reduce((function(t,e){return-1!=nt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{width:19,height:21}):t[e.tournament_id]=Object(C.jsx)(V.a,{width:19,height:21}),t}),{}),tt=z.data.reduce((function(t,e){return-1!=nt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{width:28,height:28}):t[e.tournament_id]=Object(C.jsx)(V.a,{}),t}),{}),et=z.data.reduce((function(t,e){return-1!=nt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{}):t[e.tournament_id]=Object(C.jsx)(V.a,{width:24,height:24}),t}),{});var it,ct,rt,ot=function(t){Object(u.a)(n,t);var e=Object(j.a)(n);function n(t){var s;return Object(l.a)(this,n),(s=e.call(this,t)).state={activeModal:null,modalHistory:[],popout:null,snackbar:null,elem:null,bellsButtons:$,bellsAndroid:tt,bellsIOS:et},s.sendPost=s.sendPost.bind(Object(m.a)(s)),s.shareTargetRef=a.a.createRef(),s.shareLink=s.shareLink.bind(Object(m.a)(s)),s.closeActionSheet=function(){s.setState({popout:null})},s.modalBack=function(){s.setActiveModal(s.state.modalHistory[s.state.modalHistory.length-2])},s}return Object(d.a)(n,[{key:"subscribeToNotification",value:function(t){var e,n=this;-1==nt.indexOf(t.tournament_id)?H(t).then((function(){nt.push(t.tournament_id),tt[t.tournament_id]=Object(C.jsx)(q.a,{width:28,height:28}),et[t.tournament_id]=Object(C.jsx)(q.a,{}),$[t.tournament_id]=Object(C.jsx)(q.a,{width:19,height:21}),n.setState({bellsAndroid:tt}),n.setState({bellsIOS:et}),n.setState({bellsButtons:$}),e=Object(C.jsx)(h.x,{onClose:function(){return n.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--green)"},children:Object(C.jsx)(M.a,{fill:"#fff",width:14,height:14})}),children:"\u0412\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u044b \u043e \u043d\u0430\u0447\u0430\u043b\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u043d\u0430 \u0442\u0443\u0440\u043d\u0438\u0440"}),n.setState({snackbar:e})})).catch((function(){e=Object(C.jsx)(h.x,{onClose:function(){return n.setState({snackbar:null})},duration:"1500",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--red)"},children:Object(C.jsx)(A.a,{fill:"#fff",width:14,height:14})}),children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0435 \u043d\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435"}),n.setState({snackbar:e})})):D(t).then((function(){nt.splice(nt.indexOf(t.tournament_id),1),tt[t.tournament_id]=Object(C.jsx)(V.a,{}),et[t.tournament_id]=Object(C.jsx)(V.a,{width:24,height:24}),$[t.tournament_id]=Object(C.jsx)(V.a,{width:19,height:21}),n.setState({bellsAndroid:tt}),n.setState({bellsIOS:et}),n.setState({bellsButtons:$})})).catch((function(){e=Object(C.jsx)(h.x,{onClose:function(){return n.setState({snackbar:null})},duration:"1500",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--red)"},children:Object(C.jsx)(A.a,{fill:"#fff",width:14,height:14})}),children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0438\u0441\u043a\u0435 \u043e\u0442 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),n.setState({snackbar:e})}))}},{key:"buildRequest",value:function(t){return{message:I(t.start_at,"day")+' \u0437\u0430\u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d \u0442\u0443\u0440\u043d\u0438\u0440 "'+t.title+'"\n\n\u041d\u0430\u0447\u0430\u043b\u043e \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: '+I(t.registration_start_at,"dayAndTime")+"\n\u041e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: "+I(t.registration_end_at,"dayAndTime")+"\n\n\u041d\u0430\u0447\u0430\u043b\u043e \u0431\u043e\u0435\u0432: "+I(t.start_at,"dayAndTime")+"\n\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043c\u043e\u0436\u043d\u043e \u0443\u0437\u043d\u0430\u0442\u044c \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438:",attachments:"https://vk.com/app7446072#"+t.tournament_id}}},{key:"sendPost",value:function(){var t=this,e=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--green)"},children:Object(C.jsx)(M.a,{fill:"#fff",width:14,height:14})}),children:"\u0417\u0430\u043f\u0438\u0441\u044c \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u0430"}),n=this.buildRequest(this.state.elem);o.a.send("VKWebAppShowWallPostBox",n).then((function(n){t.state.snackbar||t.setState({snackbar:e})}))}},{key:"shareLink",value:function(){var t=this,e=this.props.viewWidth>h.B.MOBILE,n=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--green)"},children:Object(C.jsx)(M.a,{fill:"#fff",width:14,height:14})}),children:e?"\u0421\u0441\u044b\u043b\u043a\u0430 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430":"\u0421\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430"}),s=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--red)"},children:Object(C.jsx)(A.a,{fill:"#fff",width:14,height:14})}),children:e?"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u0441\u044b\u043b\u043a\u0438":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0441\u0441\u044b\u043b\u043a\u0438"}),a="https://vk.com/app7446072#"+this.state.elem.tournament_id;e?o.a.send("VKWebAppCopyText",{text:a}).then((function(){t.state.snackbar||t.setState({snackbar:n})})).catch((function(){t.state.snackbar||t.setState({snackbar:s})})):o.a.send("VKWebAppShare",{link:a}).then((function(e){if(t.props.viewWidth>h.B.MOBILE){if(t.state.snackbar)return;t.setState({snackbar:n})}}))}},{key:"openShareActionSheet",value:function(t){var e=this;U=!1,X=event.target.closest(".vkuiButton").getBoundingClientRect().height,K=event.target.closest(".vkuiButton").getBoundingClientRect().top,J=event.target.closest(".vkuiButton").getBoundingClientRect().left;var n=this.props.viewWidth>h.B.MOBILE;if(!n){var s={actionShet:t.tournament_id};history.pushState(s,"")}this.setState({elem:t}),this.setState({popout:Object(C.jsxs)(h.b,{onClose:function(){return e.setState({popout:null})},iosCloseItem:Object(C.jsx)(h.c,{autoclose:!0,mode:"cancel",children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),header:"\u041a\u0430\u043a \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u043c?",toggleRef:this.shareTargetRef.current,children:[Object(C.jsx)(h.c,{autoclose:!0,onClick:function(){return e.sendPost()},children:"\u041d\u0430 \u0441\u0442\u0435\u043d\u0435"}),Object(C.jsx)(h.c,{autoclose:!0,onClick:function(){return e.shareLink()},children:n?"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443"})]})})}},{key:"setActiveModal",value:function(t){t=t||null;var e=this.state.modalHistory?Object(b.a)(this.state.modalHistory):[];null===t?e=[]:-1!==e.indexOf(t)?e=e.splice(0,e.indexOf(t)+1):e.push(t),this.setState({activeModal:t,modalHistory:e})}},{key:"checkSubscriptions",value:function(){var t=this,e=new XMLHttpRequest;e.open("GET","https://wotbtournamentvkapp.ru/vkapp/activeSubscriptions".concat(window.location.search),!0),e.send(),e.onload=function(){try{nt=JSON.parse(e.responseText)}catch(n){console.log(n)}$=z.data.reduce((function(t,e){return-1!=nt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{width:19,height:21}):t[e.tournament_id]=Object(C.jsx)(V.a,{width:19,height:21}),t}),{}),tt=z.data.reduce((function(t,e){return-1!=nt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{width:28,height:28}):t[e.tournament_id]=Object(C.jsx)(V.a,{}),t}),{}),et=z.data.reduce((function(t,e){return-1!=nt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{}):t[e.tournament_id]=Object(C.jsx)(V.a,{width:24,height:24}),t}),{}),t.setState({bellsAndroid:tt}),t.setState({bellsIOS:et}),t.setState({bellsButtons:$})}}},{key:"componentDidMount",value:function(){""==window.location.hash||Y||-1==Q.indexOf(Number(window.location.hash.slice(1)))||(this.setActiveModal(Number(window.location.hash.slice(1))),Y=!0),this.checkSubscriptions(),Z=(new Date).getTime()}},{key:"componentDidUpdate",value:function(){var t=document.getElementsByClassName("vkuiActionSheet--desktop");t[0]&&new MutationObserver((function(e){e&&!U&&(document.documentElement.clientHeight-K<200?K=K-t[0].getBoundingClientRect().height-5:K+=X+5,t[0].style.top=K+"px",t[0].style.left=J+"px",U=!0)})).observe(t[0],{attributes:!0,attributeFilter:["style"]})}},{key:"render",value:function(){var t=this;window.addEventListener("scroll",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("focus",(function(){!st&&at<6&&(t.checkSubscriptions(),st=!0,at+=1,(new Date).getTime()-Z>2500&&(at=0,Z=(new Date).getTime()),6==at&&setTimeout((function(){at=0}),3e4))})),window.addEventListener("blur",(function(){st&&(st=!1)})),window.addEventListener("popstate",(function(){null!=t.state.popout&&t.closeActionSheet()}));var e=this.props.viewWidth>h.B.MOBILE,n=this.props.viewWidth<=h.B.MOBILE,s=this.props.platform;if(0!==z.data.length)var a=Object(C.jsx)(h.p,{activeModal:this.state.activeModal,onClose:this.modalBack,children:z.data.map((function(e){return Object(C.jsx)(h.n,{id:e.tournament_id,onClose:t.modalBack,header:Object(C.jsx)(h.o,{left:n&&s===h.m&&Object(C.jsx)(h.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsIOS[e.tournament_id]})||n&&s===h.a&&Object(C.jsx)(h.t,{onClick:t.modalBack}),right:n&&s===h.m&&Object(C.jsx)(h.s,{onClick:t.modalBack,children:Object(C.jsx)(R.a,{})})||n&&s===h.a&&Object(C.jsx)(h.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsAndroid[e.tournament_id]})||Object(C.jsx)(h.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsAndroid[e.tournament_id]}),children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),children:Object(C.jsxs)("div",{className:"ModalPage__Content Turnament-Information__Group",children:[Object(C.jsx)(h.k,{className:"vkuiGroup--custom-separator",children:Object(C.jsx)("h4",{children:e.title})}),Object(C.jsxs)(h.k,{className:"vkuiGroup--custom-separator",children:[Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0421\u0442\u0430\u0442\u0443\u0441"}),Object(C.jsx)("div",{style:{marginLeft:5},children:Object(C.jsx)("span",{style:{display:"inline-flex",alignItems:"center"},children:"\u0417\u0430\u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d"})}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(k.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_start_at})]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(p.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_end_at})]})]}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u043e\u0451\u0432"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(g.a,{width:17,height:17,style:{color:"green"}}),Object(C.jsx)(B,{timestamp:e.start_at})]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(g.a,{width:17,height:17,style:{color:"rgb(200, 0, 0)"}}),Object(C.jsx)(B,{timestamp:e.end_at})]})]}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"}),Object(C.jsx)("div",{style:{marginLeft:5},children:Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)("span",{style:{fontWeight:"450"},children:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",F[e.tournament_id].max]})})]}),Object(C.jsx)(h.k,{className:"vkuiGroup--custom-separator",children:Object(C.jsx)("p",{className:"Pre",children:e.description})})]})})}))}),i=Object(C.jsxs)(h.v,{modal:a,popout:this.state.popout,children:[Object(C.jsx)(h.i,{size:e?"m":"l",children:z.data.map((function(e){return Object(C.jsxs)(h.h,{mode:"outline",children:[Object(C.jsx)("div",{className:e.status+" border"}),Object(C.jsxs)("div",{className:"TournamentCard",children:[Object(C.jsx)("div",{className:"TournamentCard__Header",children:e.title}),Object(C.jsxs)("div",{className:"TornamentCard__Info",children:[Object(C.jsxs)("div",{className:"TornamentCard__Info-Start",children:[Object(C.jsx)(O.a,{width:23,height:23}),Object(C.jsx)("div",{className:"TornamentCard__Info-Start-Text",children:Object(C.jsx)(B,{timestamp:e.start_at,mode:"day"})})]}),Object(C.jsxs)("div",{className:"TournamentCard__Info-Main",children:[Object(C.jsxs)("div",{className:"TournamentCard__Info-Main-Registration",children:[Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(k.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_start_at})]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(p.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_end_at})]})]})]}),Object(C.jsxs)("div",{className:"TournamentCard__Info-Main-Start",children:[Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041d\u0430\u0447\u0430\u043b\u043e \u0431\u043e\u0451\u0432"}),Object(C.jsx)("div",{style:{marginLeft:5},children:Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(g.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.start_at,mode:"dayAndTime"})]})})]})]})]}),Object(C.jsxs)("div",{className:"TornamentCard__Footer",children:[Object(C.jsx)(h.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-InfoButton",mode:"outline",before:Object(C.jsx)(T.a,{}),onClick:function(){return t.setActiveModal(e.tournament_id)},children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"}),Object(C.jsx)(h.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",getRootRef:t.shareTargetRef,onClick:function(){return t.openShareActionSheet(e)},children:Object(C.jsx)(w.a,{})}),Object(C.jsx)(h.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsButtons[e.tournament_id]})]})]})]})}))}),this.state.snackbar]});else if("none"==this.props.mode)i=Object(C.jsx)("span",{});else i=Object(C.jsx)(h.u,{children:"\u041d\u0435\u0442 \u0437\u0430\u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u0432"});return i}}]),n}(a.a.Component),lt=Object(h.D)(Object(h.C)(ot,{viewWidth:!0})),dt=!1;o.a.subscribe((function(t){"VKWebAppViewRestore"===t.detail.type&&(dt=!0)})),dt||((it=new XMLHttpRequest).open("POST","https://api.wotblitz.ru/wotb/tournaments/list/?application_id=132530213b8f23d4c0e1d1f423c307a9&status=registration_started",!1),it.send(),ct=JSON.parse(it.responseText),rt=ct.data.reduce((function(t,e){var n=new XMLHttpRequest;return n.open("POST","https://api.wotblitz.ru/wotb/tournaments/info/?application_id=132530213b8f23d4c0e1d1f423c307a9&tournament_id="+e.tournament_id+"&fields=teams",!1),n.send(),t[e.tournament_id]=JSON.parse(n.responseText).data[e.tournament_id].teams,t}),{}));var ut,jt,ht,bt,mt,ft=!1,Ot=[],xt={},pt={},vt={},gt=[],_t=!1,kt=0;ct.data.map((function(t){Ot.push(t.tournament_id),sessionStorage.setItem(t.tournament_id,!0)})),xt=ct.data.reduce((function(t,e){return-1!=gt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{width:19,height:21}):t[e.tournament_id]=Object(C.jsx)(V.a,{width:19,height:21}),t}),{}),pt=ct.data.reduce((function(t,e){return-1!=gt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{width:28,height:28}):t[e.tournament_id]=Object(C.jsx)(V.a,{}),t}),{}),vt=ct.data.reduce((function(t,e){return-1!=gt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{}):t[e.tournament_id]=Object(C.jsx)(V.a,{width:24,height:24}),t}),{});var yt,wt,St,Tt=function(t){Object(u.a)(n,t);var e=Object(j.a)(n);function n(t){var s;return Object(l.a)(this,n),(s=e.call(this,t)).state={activeModal:null,modalHistory:[],popout:null,snackbar:null,elem:null,bellsButtons:xt,bellsAndroid:pt,bellsIOS:vt},s.shareTargetRef=a.a.createRef(),s.sendPost=s.sendPost.bind(Object(m.a)(s)),s.shareLink=s.shareLink.bind(Object(m.a)(s)),s.closeActionSheet=function(){s.setState({popout:null})},s.modalBack=function(){s.setActiveModal(s.state.modalHistory[s.state.modalHistory.length-2])},s}return Object(d.a)(n,[{key:"subscribeToNotification",value:function(t){var e,n=this;-1==gt.indexOf(t.tournament_id)?H(t).then((function(){gt.push(t.tournament_id),pt[t.tournament_id]=Object(C.jsx)(q.a,{width:28,height:28}),vt[t.tournament_id]=Object(C.jsx)(q.a,{}),xt[t.tournament_id]=Object(C.jsx)(q.a,{width:19,height:21}),n.setState({bellsAndroid:pt}),n.setState({bellsIOS:vt}),n.setState({bellsButtons:xt}),e=Object(C.jsx)(h.x,{onClose:function(){return n.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--green)"},children:Object(C.jsx)(M.a,{fill:"#fff",width:14,height:14})}),children:"\u0412\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u044b \u043e \u043d\u0430\u0447\u0430\u043b\u0435 \u0431\u043e\u0451\u0432 \u0442\u0443\u0440\u043d\u0438\u0440\u0430"}),n.setState({snackbar:e})})).catch((function(){e=Object(C.jsx)(h.x,{onClose:function(){return n.setState({snackbar:null})},duration:"1500",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--red)"},children:Object(C.jsx)(A.a,{fill:"#fff",width:14,height:14})}),children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0435 \u043d\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435"}),n.setState({snackbar:e})})):D(t).then((function(){gt.splice(gt.indexOf(t.tournament_id),1),pt[t.tournament_id]=Object(C.jsx)(V.a,{}),vt[t.tournament_id]=Object(C.jsx)(V.a,{width:24,height:24}),xt[t.tournament_id]=Object(C.jsx)(V.a,{width:19,height:21}),n.setState({bellsAndroid:pt}),n.setState({bellsIOS:vt}),n.setState({bellsButtons:xt})})).catch((function(){e=Object(C.jsx)(h.x,{onClose:function(){return n.setState({snackbar:null})},duration:"1500",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--red)"},children:Object(C.jsx)(A.a,{fill:"#fff",width:14,height:14})}),children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0438\u0441\u043a\u0435 \u043e\u0442 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),n.setState({snackbar:e})}))}},{key:"setActiveModal",value:function(t){t=t||null;var e=this.state.modalHistory?Object(b.a)(this.state.modalHistory):[];null===t?e=[]:-1!==e.indexOf(t)?e=e.splice(0,e.indexOf(t)+1):e.push(t),this.setState({activeModal:t,modalHistory:e})}},{key:"buildRequest",value:function(t){return{message:'\u041d\u0430\u0447\u0430\u043b\u0430\u0441\u044c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u0430 \u0442\u0443\u0440\u043d\u0438\u0440 "'+t.title+'"\n\u041e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: '+I(t.registration_end_at,"dayAndTime")+"\n\u041d\u0430\u0447\u0430\u043b\u043e \u0431\u043e\u0435\u0432: "+I(t.start_at,"dayAndTime")+"\n\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043c\u043e\u0436\u043d\u043e \u0443\u0437\u043d\u0430\u0442\u044c \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438:",attachments:"https://vk.com/app7446072#"+t.tournament_id}}},{key:"sendPost",value:function(){var t=this,e=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--green)"},children:Object(C.jsx)(M.a,{fill:"#fff",width:14,height:14})}),children:"\u0417\u0430\u043f\u0438\u0441\u044c \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u0430"}),n=this.buildRequest(this.state.elem);o.a.send("VKWebAppShowWallPostBox",n).then((function(n){t.state.snackbar||t.setState({snackbar:e})}))}},{key:"shareLink",value:function(){var t=this,e=this.props.viewWidth>h.B.MOBILE,n=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--green)"},children:Object(C.jsx)(M.a,{fill:"#fff",width:14,height:14})}),children:e?"\u0421\u0441\u044b\u043b\u043a\u0430 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430":"\u0421\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430"}),s=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--red)"},children:Object(C.jsx)(A.a,{fill:"#fff",width:14,height:14})}),children:e?"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u0441\u044b\u043b\u043a\u0438":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0441\u0441\u044b\u043b\u043a\u0438"}),a="https://vk.com/app7446072#"+this.state.elem.tournament_id;e?o.a.send("VKWebAppCopyText",{text:a}).then((function(){t.state.snackbar||t.setState({snackbar:n})})).catch((function(){t.state.snackbar||t.setState({snackbar:s})})):o.a.send("VKWebAppShare",{link:a}).then((function(e){if(t.props.viewWidth>h.B.MOBILE){if(t.state.snackbar)return;t.setState({snackbar:n})}}))}},{key:"openShareActionSheet",value:function(t){var e=this;ht=!1,bt=event.target.closest(".vkuiButton").getBoundingClientRect().height,ut=event.target.closest(".vkuiButton").getBoundingClientRect().top,jt=event.target.closest(".vkuiButton").getBoundingClientRect().left;var n=this.props.viewWidth>h.B.MOBILE;if(!n){var s={actionShet:t.tournament_id};history.pushState(s,"")}this.setState({elem:t}),this.setState({popout:Object(C.jsxs)(h.b,{onClose:function(){return e.setState({popout:null})},iosCloseItem:Object(C.jsx)(h.c,{autoclose:!0,mode:"cancel",children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),header:"\u041a\u0430\u043a \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u043c?",toggleRef:this.shareTargetRef.current,children:[Object(C.jsx)(h.c,{autoclose:!0,onClick:function(){return e.sendPost()},children:"\u041d\u0430 \u0441\u0442\u0435\u043d\u0435"}),Object(C.jsx)(h.c,{autoclose:!0,onClick:function(){return e.shareLink()},children:n?"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443"})]})})}},{key:"checkSubscriptions",value:function(){var t=this,e=new XMLHttpRequest;e.open("GET","https://wotbtournamentvkapp.ru/vkapp/activeSubscriptions".concat(window.location.search),!0),e.send(),e.onload=function(){try{gt=JSON.parse(e.responseText)}catch(n){console.log(n)}xt=ct.data.reduce((function(t,e){return-1!=gt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{width:19,height:21}):t[e.tournament_id]=Object(C.jsx)(V.a,{width:19,height:21}),t}),{}),pt=ct.data.reduce((function(t,e){return-1!=gt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{width:28,height:28}):t[e.tournament_id]=Object(C.jsx)(V.a,{}),t}),{}),vt=ct.data.reduce((function(t,e){return-1!=gt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{}):t[e.tournament_id]=Object(C.jsx)(V.a,{width:24,height:24}),t}),{}),t.setState({bellsAndroid:pt}),t.setState({bellsIOS:vt}),t.setState({bellsButtons:xt})}}},{key:"componentDidMount",value:function(){""==window.location.hash||ft||-1==Ot.indexOf(Number(window.location.hash.slice(1)))||(this.setActiveModal(Number(window.location.hash.slice(1))),ft=!0),this.checkSubscriptions(),mt=(new Date).getTime()}},{key:"componentDidUpdate",value:function(){var t=document.getElementsByClassName("vkuiActionSheet--desktop");t[0]&&new MutationObserver((function(e){e&&!ht&&(document.documentElement.clientHeight-ut<200?ut=ut-t[0].getBoundingClientRect().height-5:ut+=bt+5,t[0].style.top=ut+"px",t[0].style.left=jt+"px",ht=!0)})).observe(t[0],{attributes:!0,attributeFilter:["style"]})}},{key:"render",value:function(){var t=this;window.addEventListener("scroll",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("focus",(function(){!_t&&kt<6&&(t.checkSubscriptions(),_t=!0,kt+=1,(new Date).getTime()-mt>2500&&(kt=0,mt=(new Date).getTime()),6==kt&&setTimeout((function(){kt=0}),3e4))})),window.addEventListener("blur",(function(){_t&&(_t=!1)})),window.addEventListener("popstate",(function(){null!=t.state.popout&&t.closeActionSheet()}));var e=this.props.viewWidth>h.B.MOBILE,n=this.props.viewWidth<=h.B.MOBILE,s=this.props.platform;if(0!==ct.data.length)var a=Object(C.jsx)(h.p,{activeModal:this.state.activeModal,onClose:this.modalBack,children:ct.data.map((function(e){return Object(C.jsx)(h.n,{id:e.tournament_id,onClose:t.modalBack,header:Object(C.jsx)(h.o,{left:n&&s===h.m&&Object(C.jsx)(h.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsIOS[e.tournament_id]})||n&&s===h.a&&Object(C.jsx)(h.t,{onClick:t.modalBack}),right:n&&s===h.m&&Object(C.jsx)(h.s,{onClick:t.modalBack,children:Object(C.jsx)(R.a,{})})||n&&s===h.a&&Object(C.jsx)(h.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsAndroid[e.tournament_id]})||Object(C.jsx)(h.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsAndroid[e.tournament_id]}),children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),children:Object(C.jsxs)("div",{className:"ModalPage__Content Turnament-Information__Group",children:[Object(C.jsx)(h.k,{className:"vkuiGroup--custom-separator",children:Object(C.jsx)("h4",{children:e.title})}),Object(C.jsxs)(h.k,{className:"vkuiGroup--custom-separator",children:[Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0421\u0442\u0430\u0442\u0443\u0441"}),Object(C.jsx)("div",{style:{marginLeft:5},children:Object(C.jsx)("span",{style:{display:"inline-flex",alignItems:"center"},children:"\u0418\u0434\u0451\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(k.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_start_at})]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(p.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_end_at})]})]}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u043e\u0451\u0432"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(g.a,{width:17,height:17,style:{color:"green"}}),Object(C.jsx)(B,{timestamp:e.start_at})]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(g.a,{width:17,height:17,style:{color:"rgb(200, 0, 0)"}}),Object(C.jsx)(B,{timestamp:e.end_at})]})]}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)("span",{style:{fontWeight:"450"},children:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",rt[e.tournament_id].max]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)("span",{style:{fontWeight:"450"},children:"\u0421\u043e\u0437\u0434\u0430\u043d\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",rt[e.tournament_id].total]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)("span",{style:{fontWeight:"450"},children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u043b\u043e \u0443\u0447\u0430\u0441\u0442\u0438\u0435:\xa0"})," ",null==rt[e.tournament_id].confirmed?0:rt[e.tournament_id].confirmed]})]})]}),Object(C.jsx)(h.k,{className:"vkuiGroup--custom-separator",children:Object(C.jsx)("p",{className:"Pre",children:e.description})})]})})}))}),i=Object(C.jsxs)(h.v,{modal:a,popout:this.state.popout,children:[Object(C.jsx)(h.i,{size:e?"m":"l",children:ct.data.map((function(e){return Object(C.jsxs)(h.h,{mode:"outline",children:[Object(C.jsx)("div",{className:e.status+" border"}),Object(C.jsxs)("div",{className:"TournamentCard",children:[Object(C.jsx)("div",{className:"TournamentCard__Header",children:e.title}),Object(C.jsxs)("div",{className:"TornamentCard__Info",children:[Object(C.jsxs)("div",{className:"TornamentCard__Info-Start",children:[Object(C.jsx)(O.a,{width:23,height:23}),Object(C.jsx)("div",{className:"TornamentCard__Info-Start-Text",children:Object(C.jsx)(B,{timestamp:e.start_at,mode:"day"})})]}),Object(C.jsxs)("div",{className:"TournamentCard__Info-Main",children:[Object(C.jsxs)("div",{className:"TournamentCard__Info-Main-Registration",children:[Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(k.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_start_at})]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(p.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_end_at})]})]})]}),Object(C.jsxs)("div",{className:"TournamentCard__Info-Main-Start",children:[Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041d\u0430\u0447\u0430\u043b\u043e \u0431\u043e\u0451\u0432"}),Object(C.jsx)("div",{style:{marginLeft:5},children:Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(g.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.start_at,mode:"dayAndTime"})]})})]})]})]}),Object(C.jsxs)("div",{className:"TornamentCard__Footer",children:[Object(C.jsx)(h.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-InfoButton",mode:"outline",before:Object(C.jsx)(T.a,{}),onClick:function(){return t.setActiveModal(e.tournament_id)},children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"}),Object(C.jsx)(h.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",getRootRef:t.shareTargetRef,onClick:function(){return t.openShareActionSheet(e)},children:Object(C.jsx)(w.a,{})}),Object(C.jsx)(h.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsButtons[e.tournament_id]})]})]})]})}))}),this.state.snackbar]});else if("none"==this.props.mode)i=Object(C.jsx)("span",{});else i=Object(C.jsx)(h.u,{children:"\u041d\u0435\u0442 \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u0432 \u0441 \u043d\u0430\u0447\u0430\u0432\u0448\u0435\u0439\u0441\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0435\u0439"});return i}}]),n}(a.a.Component),Ct=Object(h.D)(Object(h.C)(Tt,{viewWidth:!0})),Bt=!1;o.a.subscribe((function(t){"VKWebAppViewRestore"===t.detail.type&&(Bt=!0)})),Bt||((yt=new XMLHttpRequest).open("POST","https://api.wotblitz.ru/wotb/tournaments/list/?application_id=132530213b8f23d4c0e1d1f423c307a9&status=registration_finished",!1),yt.send(),wt=JSON.parse(yt.responseText),St=wt.data.reduce((function(t,e){var n=new XMLHttpRequest;return n.open("POST","https://api.wotblitz.ru/wotb/tournaments/info/?application_id=132530213b8f23d4c0e1d1f423c307a9&tournament_id="+e.tournament_id+"&fields=teams",!1),n.send(),t[e.tournament_id]=JSON.parse(n.responseText).data[e.tournament_id].teams,t}),{}));var It,Nt,Mt,Lt,At,Rt=!1,Wt=[],Et={},Ht={},Pt={},zt=[],Ft=!1,Dt=0;wt.data.map((function(t){Wt.push(t.tournament_id),sessionStorage.setItem(t.tournament_id,!0)})),Et=wt.data.reduce((function(t,e){return-1!=zt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{width:19,height:21}):t[e.tournament_id]=Object(C.jsx)(V.a,{width:19,height:21}),t}),{}),Ht=wt.data.reduce((function(t,e){return-1!=zt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{width:28,height:28}):t[e.tournament_id]=Object(C.jsx)(V.a,{}),t}),{}),Pt=wt.data.reduce((function(t,e){return-1!=zt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{}):t[e.tournament_id]=Object(C.jsx)(V.a,{width:24,height:24}),t}),{});var Vt,qt,Gt,Kt=function(t){Object(u.a)(n,t);var e=Object(j.a)(n);function n(t){var s;return Object(l.a)(this,n),(s=e.call(this,t)).state={activeModal:null,modalHistory:[],popout:null,snackbar:null,elem:null,bellsButtons:Et,bellsAndroid:Ht,bellsIOS:Pt},s.sendPost=s.sendPost.bind(Object(m.a)(s)),s.shareTargetRef=a.a.createRef(),s.shareLink=s.shareLink.bind(Object(m.a)(s)),s.closeActionSheet=function(){s.setState({popout:null})},s.modalBack=function(){s.setActiveModal(s.state.modalHistory[s.state.modalHistory.length-2])},s}return Object(d.a)(n,[{key:"subscribeToNotification",value:function(t){var e,n=this;-1==zt.indexOf(t.tournament_id)?H(t).then((function(){zt.push(t.tournament_id),Ht[t.tournament_id]=Object(C.jsx)(q.a,{width:28,height:28}),Pt[t.tournament_id]=Object(C.jsx)(q.a,{}),Et[t.tournament_id]=Object(C.jsx)(q.a,{width:19,height:21}),n.setState({bellsAndroid:Ht}),n.setState({bellsIOS:Pt}),n.setState({bellsButtons:Et}),e=Object(C.jsx)(h.x,{onClose:function(){return n.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--green)"},children:Object(C.jsx)(M.a,{fill:"#fff",width:14,height:14})}),children:"\u0412\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u044b \u043e \u043d\u0430\u0447\u0430\u043b\u0435 \u0431\u043e\u0451\u0432 \u0442\u0443\u0440\u043d\u0438\u0440\u0430"}),n.setState({snackbar:e})})).catch((function(){e=Object(C.jsx)(h.x,{onClose:function(){return n.setState({snackbar:null})},duration:"1500",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--red)"},children:Object(C.jsx)(A.a,{fill:"#fff",width:14,height:14})}),children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0435 \u043d\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435"}),n.setState({snackbar:e})})):D(t).then((function(){zt.splice(zt.indexOf(t.tournament_id),1),Ht[t.tournament_id]=Object(C.jsx)(V.a,{}),Pt[t.tournament_id]=Object(C.jsx)(V.a,{width:24,height:24}),Et[t.tournament_id]=Object(C.jsx)(V.a,{width:19,height:21}),n.setState({bellsAndroid:Ht}),n.setState({bellsIOS:Pt}),n.setState({bellsButtons:Et})})).catch((function(){e=Object(C.jsx)(h.x,{onClose:function(){return n.setState({snackbar:null})},duration:"1500",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--red)"},children:Object(C.jsx)(A.a,{fill:"#fff",width:14,height:14})}),children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0438\u0441\u043a\u0435 \u043e\u0442 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),n.state.snackbar||n.setState({snackbar:e})}))}},{key:"buildRequest",value:function(t){return{message:'\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u043b\u0430\u0441\u044c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u0430 \u0442\u0443\u0440\u043d\u0438\u0440 "'+t.title+'"\n\u041d\u0430\u0447\u0430\u043b\u043e \u0431\u043e\u0435\u0432: '+I(t.start_at)+"\n\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043c\u043e\u0436\u043d\u043e \u0443\u0437\u043d\u0430\u0442\u044c \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438:",attachments:"https://vk.com/app7446072#"+t.tournament_id}}},{key:"sendPost",value:function(){var t=this,e=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--green)"},children:Object(C.jsx)(M.a,{fill:"#fff",width:14,height:14})}),children:"\u0417\u0430\u043f\u0438\u0441\u044c \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u0430"}),n=this.buildRequest(this.state.elem);o.a.send("VKWebAppShowWallPostBox",n).then((function(n){t.state.snackbar||t.setState({snackbar:e})}))}},{key:"shareLink",value:function(){var t=this,e=this.props.viewWidth>h.B.MOBILE,n=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--green)"},children:Object(C.jsx)(M.a,{fill:"#fff",width:14,height:14})}),children:e?"\u0421\u0441\u044b\u043b\u043a\u0430 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430":"\u0421\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430"}),s=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--red)"},children:Object(C.jsx)(A.a,{fill:"#fff",width:14,height:14})}),children:e?"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u0441\u044b\u043b\u043a\u0438":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0441\u0441\u044b\u043b\u043a\u0438"}),a="https://vk.com/app7446072#"+this.state.elem.tournament_id;e?o.a.send("VKWebAppCopyText",{text:a}).then((function(){t.state.snackbar||t.setState({snackbar:n})})).catch((function(){t.state.snackbar||t.setState({snackbar:s})})):o.a.send("VKWebAppShare",{link:a}).then((function(e){if(t.props.viewWidth>h.B.MOBILE){if(t.state.snackbar)return;t.setState({snackbar:n})}}))}},{key:"openShareActionSheet",value:function(t){var e=this;Mt=!1,Lt=event.target.closest(".vkuiButton").getBoundingClientRect().height,It=event.target.closest(".vkuiButton").getBoundingClientRect().top,Nt=event.target.closest(".vkuiButton").getBoundingClientRect().left;var n=this.props.viewWidth>h.B.MOBILE;if(!n){var s={actionShet:t.tournament_id},a="";history.pushState(s,a)}if(!n){s={actionShet:t.tournament_id},a="";history.pushState(s,a)}this.setState({elem:t}),this.setState({popout:Object(C.jsxs)(h.b,{onClose:function(){return e.setState({popout:null})},iosCloseItem:Object(C.jsx)(h.c,{autoclose:!0,mode:"cancel",children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),header:"\u041a\u0430\u043a \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u043c?",toggleRef:this.shareTargetRef.current,children:[Object(C.jsx)(h.c,{autoclose:!0,onClick:function(){return e.sendPost()},children:"\u041d\u0430 \u0441\u0442\u0435\u043d\u0435"}),Object(C.jsx)(h.c,{autoclose:!0,onClick:function(){return e.shareLink()},children:n?"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443"})]})})}},{key:"setActiveModal",value:function(t){t=t||null;var e=this.state.modalHistory?Object(b.a)(this.state.modalHistory):[];null===t?e=[]:-1!==e.indexOf(t)?e=e.splice(0,e.indexOf(t)+1):e.push(t),this.setState({activeModal:t,modalHistory:e})}},{key:"checkSubscriptions",value:function(){var t=this,e=new XMLHttpRequest;e.open("GET","https://wotbtournamentvkapp.ru/vkapp/activeSubscriptions".concat(window.location.search),!0),e.send(),e.onload=function(){try{zt=JSON.parse(e.responseText)}catch(n){console.log(n)}Et=wt.data.reduce((function(t,e){return-1!=zt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{width:19,height:21}):t[e.tournament_id]=Object(C.jsx)(V.a,{width:19,height:21}),t}),{}),Ht=wt.data.reduce((function(t,e){return-1!=zt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{width:28,height:28}):t[e.tournament_id]=Object(C.jsx)(V.a,{}),t}),{}),Pt=wt.data.reduce((function(t,e){return-1!=zt.indexOf(e.tournament_id)?t[e.tournament_id]=Object(C.jsx)(q.a,{}):t[e.tournament_id]=Object(C.jsx)(V.a,{width:24,height:24}),t}),{}),t.setState({bellsAndroid:Ht}),t.setState({bellsIOS:Pt}),t.setState({bellsButtons:Et})}}},{key:"componentDidMount",value:function(){""==window.location.hash||Rt||-1==Wt.indexOf(Number(window.location.hash.slice(1)))||(this.setActiveModal(Number(window.location.hash.slice(1))),Rt=!0),this.checkSubscriptions(),At=(new Date).getTime()}},{key:"componentDidUpdate",value:function(){var t=document.getElementsByClassName("vkuiActionSheet--desktop");t[0]&&new MutationObserver((function(e){e&&!Mt&&(document.documentElement.clientHeight-It<150?It=It-t[0].getBoundingClientRect().height-5:It+=Lt+5,t[0].style.top=It+"px",t[0].style.left=Nt+"px",Mt=!0)})).observe(t[0],{attributes:!0,attributeFilter:["style"]})}},{key:"render",value:function(){var t=this;window.addEventListener("scroll",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("focus",(function(){!Ft&&Dt<6&&(t.checkSubscriptions(),Ft=!0,Dt+=1,(new Date).getTime()-At>2500&&(Dt=0,At=(new Date).getTime()),6==Dt&&setTimeout((function(){Dt=0}),3e4))})),window.addEventListener("blur",(function(){Ft&&(Ft=!1)})),window.addEventListener("popstate",(function(){null!=t.state.popout&&t.closeActionSheet()}));var e=this.props.viewWidth>h.B.MOBILE,n=this.props.viewWidth<=h.B.MOBILE,s=this.props.platform;if(0!==wt.data.length)var a=Object(C.jsx)(h.p,{activeModal:this.state.activeModal,onClose:this.modalBack,children:wt.data.map((function(e){return Object(C.jsx)(h.n,{id:e.tournament_id,onClose:t.modalBack,header:Object(C.jsx)(h.o,{left:n&&s===h.m&&Object(C.jsx)(h.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsIOS[e.tournament_id]})||n&&s===h.a&&Object(C.jsx)(h.t,{onClick:t.modalBack}),right:n&&s===h.m&&Object(C.jsx)(h.s,{onClick:t.modalBack,children:Object(C.jsx)(R.a,{})})||n&&s===h.a&&Object(C.jsx)(h.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsAndroid[e.tournament_id]})||Object(C.jsx)(h.s,{onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsAndroid[e.tournament_id]}),children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),children:Object(C.jsxs)("div",{className:"ModalPage__Content Turnament-Information__Group",children:[Object(C.jsx)(h.k,{className:"vkuiGroup--custom-separator",children:Object(C.jsx)("h4",{children:e.title})}),Object(C.jsxs)(h.k,{className:"vkuiGroup--custom-separator",children:[Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0421\u0442\u0430\u0442\u0443\u0441"}),Object(C.jsx)("div",{style:{marginLeft:5},children:Object(C.jsx)("span",{style:{display:"inline-flex",alignItems:"center"},children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"})}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(k.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_start_at})]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(p.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_end_at})]})]}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u043e\u0451\u0432"}),Object(C.jsx)("div",{style:{marginLeft:5},children:Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(g.a,{width:17,height:17,style:{color:"green"}}),Object(C.jsx)(B,{timestamp:e.start_at})]})}),Object(C.jsx)("div",{style:{marginLeft:5},children:Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(g.a,{width:17,height:17,style:{color:"rgb(200, 0, 0)"}}),Object(C.jsx)(B,{timestamp:e.end_at})]})}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)("span",{style:{fontWeight:"450"},children:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",St[e.tournament_id].max]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)("span",{style:{fontWeight:"450"},children:"\u0421\u043e\u0437\u0434\u0430\u043d\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",St[e.tournament_id].total]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)("span",{style:{fontWeight:"450"},children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u043b\u043e \u0443\u0447\u0430\u0441\u0442\u0438\u0435:\xa0"})," ",St[e.tournament_id].confirmed]})]})]}),Object(C.jsx)(h.k,{className:"vkuiGroup--custom-separator",children:Object(C.jsx)("p",{className:"Pre",children:e.description})})]})})}))}),i=Object(C.jsxs)(h.v,{modal:a,popout:this.state.popout,children:[Object(C.jsx)(h.i,{size:e?"m":"l",children:wt.data.map((function(e){return Object(C.jsxs)(h.h,{mode:"outline",children:[Object(C.jsx)("div",{className:e.status+" border"}),Object(C.jsxs)("div",{className:"TournamentCard",children:[Object(C.jsx)("div",{className:"TournamentCard__Header",children:e.title}),Object(C.jsxs)("div",{className:"TornamentCard__Info",children:[Object(C.jsxs)("div",{className:"TornamentCard__Info-Start",children:[Object(C.jsx)(O.a,{width:23,height:23}),Object(C.jsx)("div",{className:"TornamentCard__Info-Start-Text",children:Object(C.jsx)(B,{timestamp:e.start_at,mode:"day"})})]}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main TournamentCard__Info-Main-OneItem",children:Object(C.jsxs)("div",{className:"TournamentCard__Info-Main-Start",children:[Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041d\u0430\u0447\u0430\u043b\u043e \u0431\u043e\u0451\u0432"}),Object(C.jsx)("div",{style:{marginLeft:5},children:Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(k.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.start_at})]})})]})})]}),Object(C.jsxs)("div",{className:"TornamentCard__Footer",children:[Object(C.jsx)(h.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-InfoButton",mode:"outline",before:Object(C.jsx)(T.a,{}),onClick:function(){return t.setActiveModal(e.tournament_id)},children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"}),Object(C.jsx)(h.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",getRootRef:t.shareTargetRef,onClick:function(){return t.openShareActionSheet(e)},children:Object(C.jsx)(w.a,{})}),Object(C.jsx)(h.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",onClick:function(){return t.subscribeToNotification(e)},children:t.state.bellsButtons[e.tournament_id]})]})]})]})}))}),this.state.snackbar]});else if("none"==this.props.mode)i=Object(C.jsx)("span",{});else i=Object(C.jsx)(h.u,{children:"\u041d\u0435\u0442 \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u0432 \u0441 \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d\u043d\u043e\u0439 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0435\u0439"});return i}}]),n}(a.a.Component),Jt=Object(h.D)(Object(h.C)(Kt,{viewWidth:!0})),Ut=!1;o.a.subscribe((function(t){"VKWebAppViewRestore"===t.detail.type&&(Ut=!0)})),Ut||((Vt=new XMLHttpRequest).open("POST","https://api.wotblitz.ru/wotb/tournaments/list/?application_id=132530213b8f23d4c0e1d1f423c307a9&status=running",!1),Vt.send(),qt=JSON.parse(Vt.responseText),Gt=qt.data.reduce((function(t,e){var n=new XMLHttpRequest;return n.open("POST","https://api.wotblitz.ru/wotb/tournaments/info/?application_id=132530213b8f23d4c0e1d1f423c307a9&tournament_id="+e.tournament_id+"&fields=teams",!1),n.send(),t[e.tournament_id]=JSON.parse(n.responseText).data[e.tournament_id].teams,t}),{}));var Xt,Zt,Yt,Qt,$t=!1,te=[];qt.data.map((function(t){te.push(t.tournament_id),sessionStorage.setItem(t.tournament_id,!0)}));var ee,ne,se,ae=function(t){Object(u.a)(n,t);var e=Object(j.a)(n);function n(t){var s;return Object(l.a)(this,n),(s=e.call(this,t)).state={activeModal:null,modalHistory:[],popout:null,snackbar:null,elem:null},s.shareTargetRef=a.a.createRef(),s.sendPost=s.sendPost.bind(Object(m.a)(s)),s.shareLink=s.shareLink.bind(Object(m.a)(s)),s.closeActionSheet=function(){s.setState({popout:null})},s.modalBack=function(){s.setActiveModal(s.state.modalHistory[s.state.modalHistory.length-2])},s}return Object(d.a)(n,[{key:"setActiveModal",value:function(t){t=t||null;var e=this.state.modalHistory?Object(b.a)(this.state.modalHistory):[];null===t?e=[]:-1!==e.indexOf(t)?e=e.splice(0,e.indexOf(t)+1):e.push(t),this.setState({activeModal:t,modalHistory:e})}},{key:"buildRequest",value:function(t){return{message:'\u041d\u0430\u0447\u0430\u043b\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440 "'+t.title+'"\n\u041e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u0435 \u0431\u043e\u0435\u0432: '+I(t.end_at,"dayAndTime")+"\n\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043c\u043e\u0436\u043d\u043e \u0443\u0437\u043d\u0430\u0442\u044c \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438:",attachments:"https://vk.com/app7446072#"+t.tournament_id}}},{key:"sendPost",value:function(){var t=this,e=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--green)"},children:Object(C.jsx)(M.a,{fill:"#fff",width:14,height:14})}),children:"\u0417\u0430\u043f\u0438\u0441\u044c \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u0430"}),n=this.buildRequest(this.state.elem);o.a.send("VKWebAppShowWallPostBox",n).then((function(n){t.state.snackbar||t.setState({snackbar:e})}))}},{key:"shareLink",value:function(){var t=this,e=this.props.viewWidth>h.B.MOBILE,n=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--green)"},children:Object(C.jsx)(M.a,{fill:"#fff",width:14,height:14})}),children:e?"\u0421\u0441\u044b\u043b\u043a\u0430 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430":"\u0421\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430"}),s=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--red)"},children:Object(C.jsx)(A.a,{fill:"#fff",width:14,height:14})}),children:e?"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u0441\u044b\u043b\u043a\u0438":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0441\u0441\u044b\u043b\u043a\u0438"}),a="https://vk.com/app7446072#"+this.state.elem.tournament_id;e?o.a.send("VKWebAppCopyText",{text:a}).then((function(){t.state.snackbar||t.setState({snackbar:n})})).catch((function(){t.state.snackbar||t.setState({snackbar:s})})):o.a.send("VKWebAppShare",{link:a}).then((function(e){if(t.props.viewWidth>h.B.MOBILE){if(t.state.snackbar)return;t.setState({snackbar:n})}}))}},{key:"openShareActionSheet",value:function(t){var e=this;Yt=!1,Qt=event.target.closest(".vkuiButton").getBoundingClientRect().height,Xt=event.target.closest(".vkuiButton").getBoundingClientRect().top,Zt=event.target.closest(".vkuiButton").getBoundingClientRect().left;var n=this.props.viewWidth>h.B.MOBILE;if(!n){var s={actionShet:t.tournament_id};history.pushState(s,"")}this.setState({elem:t}),this.setState({popout:Object(C.jsxs)(h.b,{onClose:function(){return e.setState({popout:null})},iosCloseItem:Object(C.jsx)(h.c,{autoclose:!0,mode:"cancel",children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),header:"\u041a\u0430\u043a \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u043c?",toggleRef:this.shareTargetRef.current,children:[Object(C.jsx)(h.c,{autoclose:!0,onClick:function(){return e.sendPost()},children:"\u041d\u0430 \u0441\u0442\u0435\u043d\u0435"}),Object(C.jsx)(h.c,{autoclose:!0,onClick:function(){return e.shareLink()},children:n?"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443"})]})})}},{key:"componentDidMount",value:function(){""==window.location.hash||$t||-1==te.indexOf(Number(window.location.hash.slice(1)))||(this.setActiveModal(Number(window.location.hash.slice(1))),$t=!0)}},{key:"componentDidUpdate",value:function(){var t=document.getElementsByClassName("vkuiActionSheet--desktop");t[0]&&new MutationObserver((function(e){e&&!Yt&&(document.documentElement.clientHeight-Xt<200?Xt=Xt-t[0].getBoundingClientRect().height-5:Xt+=Qt+5,t[0].style.top=Xt+"px",t[0].style.left=Zt+"px",Yt=!0)})).observe(t[0],{attributes:!0,attributeFilter:["style"]})}},{key:"render",value:function(){var t=this;window.addEventListener("scroll",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("popstate",(function(){null!=t.state.popout&&t.closeActionSheet()}));var e=this.props.viewWidth>h.B.MOBILE,n=this.props.viewWidth<=h.B.MOBILE,s=this.props.platform;if(0!==qt.data.length)var a=Object(C.jsx)(h.p,{activeModal:this.state.activeModal,onClose:this.modalBack,children:qt.data.map((function(e){return Object(C.jsx)(h.n,{id:e.tournament_id,onClose:t.modalBack,header:Object(C.jsx)(h.o,{right:n&&s==h.m&&Object(C.jsx)(h.s,{onClick:t.modalBack,children:Object(C.jsx)(R.a,{})}),left:n&&s===h.a&&Object(C.jsx)(h.t,{onClick:t.modalBack}),children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),children:Object(C.jsxs)("div",{className:"ModalPage__Content Turnament-Information__Group",children:[Object(C.jsx)(h.k,{className:"vkuiGroup--custom-separator",children:Object(C.jsx)("h4",{children:e.title})}),Object(C.jsxs)(h.k,{className:"vkuiGroup--custom-separator",children:[Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0421\u0442\u0430\u0442\u0443\u0441"}),Object(C.jsx)("div",{style:{marginLeft:5},children:Object(C.jsx)("span",{style:{display:"inline-flex",alignItems:"center"},children:"\u0418\u0434\u0443\u0442 \u0431\u043e\u0438"})}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(k.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_start_at})]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(p.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_end_at})]})]}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u043e\u0451\u0432"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(g.a,{width:17,height:17,style:{color:"green"}}),Object(C.jsx)(B,{timestamp:e.start_at})]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(g.a,{width:17,height:17,style:{color:"rgb(200, 0, 0)"}}),Object(C.jsx)(B,{timestamp:e.end_at})]})]}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)("span",{style:{fontWeight:"450"},children:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",Gt[e.tournament_id].max]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)("span",{style:{fontWeight:"450"},children:"\u0421\u043e\u0437\u0434\u0430\u043d\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",Gt[e.tournament_id].total]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)("span",{style:{fontWeight:"450"},children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u043b\u043e \u0443\u0447\u0430\u0441\u0442\u0438\u0435:\xa0"})," ",Gt[e.tournament_id].confirmed]})]})]}),Object(C.jsx)(h.k,{className:"vkuiGroup--custom-separator",children:Object(C.jsx)("p",{className:"Pre",children:e.description})})]})})}))}),i=Object(C.jsxs)(h.v,{modal:a,popout:this.state.popout,children:[Object(C.jsx)(h.i,{size:e?"m":"l",children:qt.data.map((function(e){return Object(C.jsxs)(h.h,{mode:"outline",children:[Object(C.jsx)("div",{className:e.status+" border"}),Object(C.jsxs)("div",{className:"TournamentCard",children:[Object(C.jsx)("div",{className:"TournamentCard__Header",children:e.title}),Object(C.jsxs)("div",{className:"TornamentCard__Info",children:[Object(C.jsxs)("div",{className:"TornamentCard__Info-Start",children:[Object(C.jsx)(O.a,{width:23,height:23}),Object(C.jsx)("div",{className:"TornamentCard__Info-Start-Text",children:Object(C.jsx)(B,{timestamp:e.start_at,mode:"day"})})]}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main TournamentCard__Info-Main-OneItem",children:Object(C.jsxs)("div",{className:"TournamentCard__Info-Main-Start",children:[Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u043e\u0451\u0432"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(k.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.start_at})]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(p.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.end_at})]})]})]})})]}),Object(C.jsxs)("div",{className:"TornamentCard__Footer",children:[Object(C.jsx)(h.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-InfoButton",mode:"outline",before:Object(C.jsx)(T.a,{}),onClick:function(){return t.setActiveModal(e.tournament_id)},children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"}),Object(C.jsx)(h.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",getRootRef:t.shareTargetRef,onClick:function(){return t.openShareActionSheet(e)},children:Object(C.jsx)(w.a,{})})]})]})]})}))}),this.state.snackbar]});else if("none"==this.props.mode)i=Object(C.jsx)("span",{});else i=Object(C.jsx)(h.u,{children:"\u041d\u0435\u0442 \u043d\u0430\u0447\u0430\u0432\u0448\u0438\u0445\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u0432"});return i}}]),n}(a.a.Component),ie=Object(h.D)(Object(h.C)(ae,{viewWidth:!0})),ce=!1;o.a.subscribe((function(t){"VKWebAppViewRestore"===t.detail.type&&(ce=!0,console.log("restore2"))})),ce||(console.log("api"),(ee=new XMLHttpRequest).open("POST","https://api.wotblitz.ru/wotb/tournaments/list/?application_id=132530213b8f23d4c0e1d1f423c307a9&status=finished",!1),ee.send(),ne=JSON.parse(ee.responseText),se=ne.data.reduce((function(t,e){var n=new XMLHttpRequest;return n.open("POST","https://api.wotblitz.ru/wotb/tournaments/info/?application_id=132530213b8f23d4c0e1d1f423c307a9&tournament_id="+e.tournament_id+"&fields=teams",!1),n.send(),t[e.tournament_id]=JSON.parse(n.responseText).data[e.tournament_id].teams,t}),{}));var re,oe,le,de,ue=!1,je=[];ne.data.map((function(t){je.push(t.tournament_id),sessionStorage.setItem(t.tournament_id,!0)}));var he=function(t){Object(u.a)(n,t);var e=Object(j.a)(n);function n(t){var s;return Object(l.a)(this,n),(s=e.call(this,t)).state={activeModal:null,modalHistory:[],popout:null,snackbar:null,elem:null},s.shareTargetRef=a.a.createRef(),s.sendPost=s.sendPost.bind(Object(m.a)(s)),s.shareLink=s.shareLink.bind(Object(m.a)(s)),s.closeActionSheet=function(){s.setState({popout:null})},s.modalBack=function(){s.setActiveModal(s.state.modalHistory[s.state.modalHistory.length-2])},s}return Object(d.a)(n,[{key:"buildRequest",value:function(t){return{message:I(t.end_at,"day")+' \u043f\u0440\u043e\u0448\u0435\u043b \u0442\u0443\u0440\u043d\u0438\u0440 "'+t.title+'"\n\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043c\u043e\u0436\u043d\u043e \u0443\u0437\u043d\u0430\u0442\u044c \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438:',attachments:"https://vk.com/app7446072#"+t.tournament_id}}},{key:"sendPost",value:function(){var t=this,e=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--green)"},children:Object(C.jsx)(M.a,{fill:"#fff",width:14,height:14})}),children:"\u0417\u0430\u043f\u0438\u0441\u044c \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u0430"}),n=this.buildRequest(this.state.elem);o.a.send("VKWebAppShowWallPostBox",n).then((function(n){t.state.snackbar||t.setState({snackbar:e})}))}},{key:"shareLink",value:function(){var t=this,e=this.props.viewWidth>h.B.MOBILE,n=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--green)"},children:Object(C.jsx)(M.a,{fill:"#fff",width:14,height:14})}),children:e?"\u0421\u0441\u044b\u043b\u043a\u0430 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430":"\u0421\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430"}),s=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--red)"},children:Object(C.jsx)(A.a,{fill:"#fff",width:14,height:14})}),children:e?"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u0441\u044b\u043b\u043a\u0438":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0441\u0441\u044b\u043b\u043a\u0438"}),a="https://vk.com/app7446072#"+this.state.elem.tournament_id;e?o.a.send("VKWebAppCopyText",{text:a}).then((function(){t.state.snackbar||t.setState({snackbar:n})})).catch((function(){t.state.snackbar||t.setState({snackbar:s})})):o.a.send("VKWebAppShare",{link:a}).then((function(e){if(t.props.viewWidth>h.B.MOBILE){if(t.state.snackbar)return;t.setState({snackbar:n})}}))}},{key:"openShareActionSheetFinish",value:function(t){var e=this;le=!1,de=event.target.closest(".vkuiButton").getBoundingClientRect().height,re=event.target.closest(".vkuiButton").getBoundingClientRect().top,oe=event.target.closest(".vkuiButton").getBoundingClientRect().left;var n=this.props.viewWidth>h.B.MOBILE;if(!n){var s={actionShet:t.tournament_id};history.pushState(s,"")}this.setState({elem:t}),this.setState({popout:Object(C.jsxs)(h.b,{onClose:function(){return e.setState({popout:null})},iosCloseItem:Object(C.jsx)(h.c,{autoclose:!0,mode:"cancel",children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),header:"\u041a\u0430\u043a \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u043c?",toggleRef:this.shareTargetRef.current,children:[Object(C.jsx)(h.c,{autoclose:!0,onClick:function(){return e.sendPost()},children:"\u041d\u0430 \u0441\u0442\u0435\u043d\u0435"}),Object(C.jsx)(h.c,{autoclose:!0,onClick:function(){return e.shareLink()},children:n?"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443"})]})})}},{key:"setActiveModal",value:function(t){t=t||null;var e=this.state.modalHistory?Object(b.a)(this.state.modalHistory):[];if(null===t?e=[]:-1!==e.indexOf(t)?e=e.splice(0,e.indexOf(t)+1):e.push(t),this.props.viewWidth<=h.B.MOBILE){var n={modal:t};history.pushState(n,"")}this.setState({activeModal:t,modalHistory:e})}},{key:"componentDidMount",value:function(){""==window.location.hash||ue||-1==je.indexOf(Number(window.location.hash.slice(1)))||(this.setActiveModal(Number(window.location.hash.slice(1))),ue=!0)}},{key:"componentDidUpdate",value:function(){var t=document.getElementsByClassName("vkuiActionSheet--desktop");t[0]&&new MutationObserver((function(e){e&&!le&&(document.documentElement.clientHeight-re<200?re=re-t[0].getBoundingClientRect().height-5:re+=de+5,t[0].style.top=re+"px",t[0].style.left=oe+"px",le=!0)})).observe(t[0],{attributes:!0,attributeFilter:["style"]})}},{key:"render",value:function(){var t=this;window.addEventListener("scroll",(function(){null!=t.state.popout&&t.closeActionSheet()})),window.addEventListener("popstate",(function(){null!=t.state.popout&&t.closeActionSheet()}));var e=this.props.viewWidth>h.B.MOBILE,n=this.props.viewWidth<=h.B.MOBILE,s=this.props.platform;if(0!==ne.data.length)var a=Object(C.jsx)(h.p,{activeModal:this.state.activeModal,onClose:this.modalBack,children:ne.data.map((function(e){return Object(C.jsx)(h.n,{id:e.tournament_id,onClose:t.modalBack,header:Object(C.jsx)(h.o,{right:n&&s===h.m&&Object(C.jsx)(h.s,{onClick:t.modalBack,children:Object(C.jsx)(R.a,{})}),left:n&&s===h.a&&Object(C.jsx)(h.t,{onClick:t.modalBack}),children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),children:Object(C.jsxs)("div",{className:"ModalPage__Content Turnament-Information__Group",children:[Object(C.jsx)(h.k,{className:"vkuiGroup--custom-separator",children:Object(C.jsx)("h4",{children:e.title})}),Object(C.jsxs)(h.k,{className:"vkuiGroup--custom-separator",children:[Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0421\u0442\u0430\u0442\u0443\u0441"}),Object(C.jsx)("div",{style:{marginLeft:5},children:Object(C.jsx)("span",{style:{display:"inline-flex",alignItems:"center"},children:"\u0422\u0443\u0440\u043d\u0438\u0440 \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d"})}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(k.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_start_at})]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(p.a,{width:17,height:17}),Object(C.jsx)(B,{timestamp:e.registration_end_at})]})]}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u043e\u0451\u0432"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(g.a,{width:17,height:17,style:{color:"green"}}),Object(C.jsx)(B,{timestamp:e.start_at})]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)(g.a,{width:17,height:17,style:{color:"rgb(200, 0, 0)"}}),Object(C.jsx)(B,{timestamp:e.end_at})]})]}),Object(C.jsx)("br",{}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main-Title",children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"}),Object(C.jsxs)("div",{style:{marginLeft:5},children:[Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)("span",{style:{fontWeight:"450"},children:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043a\u043e\u043c\u0430\u043d\u0434:\xa0"})," ",se[e.tournament_id].max]}),Object(C.jsx)("br",{}),Object(C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[Object(C.jsx)("span",{style:{fontWeight:"450"},children:"\u041f\u0440\u0438\u043d\u044f\u043b\u043e \u0443\u0447\u0430\u0441\u0442\u0438\u0435:\xa0"})," ",se[e.tournament_id].total]})]})]}),Object(C.jsx)(h.k,{className:"vkuiGroup--custom-separator",children:Object(C.jsx)("p",{className:"Pre",children:e.description})})]})})}))}),i=Object(C.jsxs)(h.v,{modal:a,popout:this.state.popout,children:[Object(C.jsx)(h.i,{size:e?"m":"l",children:ne.data.map((function(e){return Object(C.jsxs)(h.h,{mode:"outline",children:[Object(C.jsx)("div",{className:e.status+" border"}),Object(C.jsxs)("div",{className:"TournamentCard",children:[Object(C.jsx)("div",{className:"TournamentCard__Header",children:e.title}),Object(C.jsxs)("div",{className:"TornamentCard__Info",children:[Object(C.jsxs)("div",{className:"TornamentCard__Info-Start",children:[Object(C.jsx)(O.a,{width:23,height:23}),Object(C.jsx)("div",{className:"TornamentCard__Info-Start-Text",children:Object(C.jsx)(B,{timestamp:e.start_at,mode:"day"})})]}),Object(C.jsx)("div",{className:"TournamentCard__Info-Main",children:"\u0422\u0443\u0440\u043d\u0438\u0440 \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d"})]}),Object(C.jsxs)("div",{className:"TornamentCard__Footer",children:[Object(C.jsx)(h.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-InfoButton",mode:"outline",before:Object(C.jsx)(T.a,{}),onClick:function(){return t.setActiveModal(e.tournament_id)},children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"}),Object(C.jsx)(h.g,{className:"TornamentCard__Footer-Button TornamentCard__Footer-SmallButton",mode:"outline",getRootRef:t.shareTargetRef,onClick:function(){return t.openShareActionSheetFinish(e)},children:Object(C.jsx)(w.a,{})})]})]})]})}))}),this.state.snackbar]});else if("none"==this.props.mode)i=Object(C.jsx)("span",{});else i=Object(C.jsx)(h.u,{children:"\u041d\u0435\u0442 \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d\u043d\u044b\u0445 \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u0432"});return i}}]),n}(a.a.Component),be=Object(h.D)(Object(h.C)(he,{viewWidth:!0})),me=function(t){Object(u.a)(n,t);var e=Object(j.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(C.jsxs)("div",{children:[Object(C.jsx)(Ct,{mode:"none"}),Object(C.jsx)(lt,{mode:"none"}),Object(C.jsx)(Jt,{mode:"none"}),Object(C.jsx)(ie,{mode:"none"}),Object(C.jsx)(be,{mode:"none"})]})}}]),n}(a.a.Component),fe=!1,Oe=function(t){Object(u.a)(n,t);var e=Object(j.a)(n);function n(t){var s;return Object(l.a)(this,n),(s=e.call(this,t)).state={contextOpened:!1,mode:"all",activeTab:"all",snackbar:null},s}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this;if(""!=window.location.hash&&!fe&&!sessionStorage.getItem(window.location.hash.slice(1))){var e=Object(C.jsx)(h.x,{onClose:function(){return t.setState({snackbar:null})},duration:"2000",before:Object(C.jsx)(h.f,{size:24,style:{background:"var(--red)"},children:Object(C.jsx)(A.a,{fill:"#fff",width:14,height:14})}),children:"\u041d\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0442\u0443\u0440\u043d\u0438\u0440\u0435"});this.setState({snackbar:e}),fe=!0}}},{key:"render",value:function(){var t,e=this;return this.props.viewWidth>h.B.MOBILE&&(window.onfocus=function(t){var e=window.scrollX,n=window.scrollY;document.body.style.height="105%",window.scroll(e,n+5),window.scroll(e,n-5),document.body.style.height="100%"}),"all"===this.state.activeTab&&(t=Object(C.jsx)(me,{})),"upcoming"===this.state.activeTab&&(t=Object(C.jsx)(lt,{})),"registration_started"===this.state.activeTab&&(t=Object(C.jsx)(Ct,{})),"registration_finished"===this.state.activeTab&&(t=Object(C.jsx)(Jt,{})),"running"===this.state.activeTab&&(t=Object(C.jsx)(ie,{})),"finish"===this.state.activeTab&&(t=Object(C.jsx)(be,{})),Object(C.jsx)(h.A,{children:Object(C.jsxs)(h.q,{children:[Object(C.jsx)(h.r,{children:"T\u0443\u0440\u043d\u0438\u0440\u044b WoT Blitz"}),Object(C.jsxs)(h.k,{style:{paddingTop:40},children:[Object(C.jsxs)(h.j,{vertical:"top",filled:!0,children:[Object(C.jsx)(h.y,{children:Object(C.jsxs)(h.l,{showArrows:!0,getScrollToLeft:function(t){return t-120},getScrollToRight:function(t){return t+120},children:[Object(C.jsx)(h.z,{onClick:function(){e.setState({activeTab:"all"}),window.scrollTo(0,0)},selected:"all"===this.state.activeTab,children:"\u0412\u0441\u0435"}),Object(C.jsx)(h.z,{onClick:function(){e.setState({activeTab:"registration_started"}),window.scrollTo(0,0)},selected:"registration_started"===this.state.activeTab,children:"\u0418\u0434\u0451\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(C.jsx)(h.z,{onClick:function(){e.setState({activeTab:"upcoming"}),window.scrollTo(0,0)},selected:"upcoming"===this.state.activeTab,children:"\u0417\u0430\u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435"}),Object(C.jsx)(h.z,{onClick:function(){e.setState({activeTab:"registration_finished"}),window.scrollTo(0,0)},selected:"registration_finished"===this.state.activeTab,children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"}),Object(C.jsx)(h.z,{onClick:function(){e.setState({activeTab:"running"}),window.scrollTo(0,0)},selected:"running"===this.state.activeTab,children:"\u0418\u0434\u0443\u0442 \u0431\u043e\u0438"}),Object(C.jsx)(h.z,{onClick:function(){e.setState({activeTab:"finish"}),window.scrollTo(0,0)},selected:"finish"===this.state.activeTab,children:"\u0411\u043e\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u044b"})]})}),Object(C.jsx)(h.w,{wide:!0})]}),t,this.state.snackbar]})]})})}}]),n}(a.a.Component),xe=Object(h.D)((function(){return Object(C.jsx)(h.d,{children:Object(C.jsx)(h.e,{children:Object(C.jsx)(Oe,{})})})}));n(278);o.a.send("VKWebAppInit"),o.a.subscribe((function(t){"VKWebAppUpdateConfig"===t.detail.type&&document.body.setAttribute("scheme",t.detail.data.scheme)})),c.a.render(Object(C.jsx)(xe,{}),document.getElementById("root")),Promise.all([n.e(3),n.e(4)]).then(n.bind(null,286)).then((function(t){t.default}))}},[[279,1,2]]]);
//# sourceMappingURL=main.5dc442b3.chunk.js.map